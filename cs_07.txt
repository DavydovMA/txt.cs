Project         : txt.cs
Release version : 1.6.43
Last update     : 2018-10-02
------------- ---- ------
file            : cs_07.txt

Шифрование асимметричное.

7. Шифрование асимметричное.

    "Когда вы положите сообщение в сундук и защелкните навесной замок, никто включая вас, не сможет открыть его и прочесть сообщение. Для этого нужен ключ к замку..." ист.lxf-2013-174.

7.1. Шифрование асимметричное.

    При асимметричном шифровании "...используется пара ключей, хотя на самом деле это две части одного и того же ключа. Они называются закрытым (секретным) и открытым (публичным) ключами. Для шифрования используется только один из них, и только закрытый ключ нужен для расшифровки сообщения. Это означает, что я могу легко отправить свой открытый ключ по незащищенным каналам, так как он используется только для шифрования, а не для дешифровки..." ист.lxf-2013-174. Очень удобно в ТОКСИЧНО/АГРЕССИВНОЙ среде.
    Ключи из себя представляют файлы. Один называется открытый и чем больше он распространен, тем сложнее будет его скомпроментировать (подделать). Другой называется закрытый и его надо хорошенько спрятать, желательно в защищенное хранилище. То что зашифровано одним ключом, может быть расшифровано только другим ключом и наоборот.
    И тут как всегда есть масса программ имя которым легион.

7.2. PGP.

    PGP - Pretty Good Privacy (Достаточно Хороша Конфедициальность).

    Вспоминаю время когда интернет был, но так чтобы по быстрому и по работе и только с разрешения самого главного. Поэтому для меня интернет начался с покупки CD-диска. Кстати CD-привод были тоже в диковинку и в одном экземпляре, но доступ был свободнее и по времени не ограничен. И те 700 Мб с болванки постепенно "научились" переползать на пятидюймовую дискету, которую можно было просматривать не на IBM совместимом компьютере, а оттуда ровно укладывались на магнитофонную ленту (вот где было реальное шифрование данных). В то время не было бесконечного, скоростного, бессмысленного кликанья, да и мышки не было. Информация поглащалась, как питон поглащает попавшуюся жертву. И вспоминаю, именно оттуда зачитывался, как где-то в далекой ненавистной америке притесняют человека придумавшего честный алгоритм шифрования. Как ему угрожали, как пытались давить и требовали исправить алгоритм с целью внесения закладки, покушались на жизнь и пришлось скрываться, и как он в конце воспользовался конституционным правом свободы прессы и просто опубликовал его. И назывался этот алгоритм шифрования PGP. Да давно это было, но именно благодаря той публикации сейчас существует масса реализаций алгоритма (протокола) шифрования PGP.

    Надо доосознать, что PGP можно использовать не только как инструмент шифрования. PGP позволяет подписывать открытые сообщения (любой файл) гарантируя, что в них не было изменено ни единого битика. PGP позволяет создавать доверенную сеть открытых ключей и скомпроментированных ключей. В консольном варианте вездесущ. Очень гибкий и мощный инструмент. Если верить в предсказания, то гарантируется не вскрываемость этого алгоритма до 2030 года (по техническим ограничениям).

7.3. OpenPGP.

    Найдем что-нибудь из открытого, максимально доступного, например [gpg].

7.3.0. Документация.

    Всегда следует начинать с документации, в зависимости от реализации всегда возможны отличия. Документация единственный советчик и первоисточник заслуживающий доверия. Читаем описание не спеша за кружечкой кофе и бутербродиками. 


example > man gpg


    Обращаем внимание на опцию [--homedir] позволяющую указать домашний каталог, например защищенное хранилище. После ознакомления с описанием говорим "КУ" нажатием клавиши [q].

7.3.1. Песочница.

7.3.1.0. Развлекаться будем как обычно в каталоге [/tmp] куда и перебираемся.


example > cd /tmp


7.3.1.1. Проверяем содержимое каталога [/tmp].


example > ls -l
total 0


    У меня так, у вас не важно.

7.3.1.2. Создаем домашний каталог [dir_malvina], никто не запрещает между делом подмонтировать защищенное хранилище.


example malvina > mkdir -v /tmp/dir_malvina
mkdir: created directory '/tmp/dir_malvina'


7.3.1.3. Проверяем содержимое нового каталога [dir_malvina].


example malvina > ls -l /tmp/dir_malvina
total 0


7.3.1.4. Создаем домашний каталог [dir_buratino], и здесь точно будет подмонтировано защищенное хранилище быстро и незаметно.


example buratino > mkdir -v /tmp/dir_buratino
mkdir: created directory '/tmp/dir_buratino'


7.3.1.5. Проверяем содержимое каталога [dir_buratino].


example buratino > ls -l /tmp/dir_buratino/
total 0


7.3.2. Создание пары ключей.

    Пара ключей - связка, keyring. Начинается с малого и потом растет. Возьмите в руки связку ваших ключей и посмотрите на нее. Всегда можно добавить новые, снять не нужные или оставить на память для солидности.

7.3.2.0. Применение опциии [--homedir] позволяет указать (сменить) домашний каталог [dir_malvina] (место хранения ключей). Применив команду [--gen-key] запускаем процесс создания пары ключей. В процессе создания указываем реальное имя для удобства идентификации в дальнейшем, контактный адрес электронной почты и задаем ключ/пароль. Когда вам покажется, что программа зависла на самом деле надо подвигать мышкой или как попало понажимать кнопки клавиатуры (поаккуратней) для генерации случайных байт.


example malvina > gpg --homedir /tmp/dir_malvina --gen-key 
gpg: WARNING: unsafe permissions on homedir '/tmp/dir_malvina'
gpg *
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

gpg: keybox '/tmp/dir_malvina/pubring.kbx' created
Note: Use "gpg --full-generate-key" for a full featured key generation dialog.

GnuPG needs to construct a user ID to identify your key.

Real name: Malvina Karabasovna
Email address: malvina@mail
You selected this USER-ID:
    "Malvina Karabasovna <malvina@mail>"

Change (N)ame, (E)mail, or (O)kay/(Q)uit? O
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: /tmp/dir_malvina/trustdb.gpg: trustdb created
gpg: key 01C2ABCE329C32E4 marked as ultimately trusted
gpg: directory '/tmp/dir_malvina/openpgp-revocs.d' created
gpg: revocation certificate stored as '/tmp/dir_malvina/openpgp-revocs.d/E863BA814540018D08AA519101C2ABCE329C32E4.rev'
public and secret key created and signed.

pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid                      Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |  <-- secure key
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |  <-- open   key
    +-----+----------+------------------------------------------+


    Собственно вот и все, пара ключей готова к использованию.

7.3.2.1. Проверяем содержимое каталога [dir_malvina], для рекурсивного просмотра добавляем опцию [-R].


example malvina > ls -l -R /tmp/dir_malvina
/tmp/dir_malvina:
total 20
drwx------ 2 root root 4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root 4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root 1976 Apr  6 20:13 pubring.kbx
-rw------- 1 root root   32 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root 1240 Apr  6 20:13 trustdb.gpg

/tmp/dir_malvina/openpgp-revocs.d:
total 4
-rw------- 1 root root 1636 Apr  6 20:13 E863BA814540018D08AA519101C2ABCE329C32E4.rev

/tmp/dir_malvina/private-keys-v1.d:
total 8
-rw------- 1 root root 1623 Apr  6 20:13 62E1A5F8036D4625C6CBDFA7BB32985D9A8BC909.key
-rw------- 1 root root 1623 Apr  6 20:13 AA9C92EF44315E8E803A0EF149F9C63C9F7A5389.key


7.3.2.2. Применив команду [--list-public-keys] смотрим список имеющихся открытых ключей.


example malvina > gpg --homedir /tmp/dir_malvina --list-public-keys 
gpg: WARNING: unsafe permissions on homedir '/tmp/dir_malvina'
/tmp/dir_malvina/pubring.kbx
-------------------------------------------
pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid           [ultimate] Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]


    Получаем информацию об открытом (публичном, public, pub) ключе:
      алгоритм шифрования  - rsa;
      длина ключа          - 3072;
      дата создания        - 2013-04-06;
      срок годности до     - 2015-04-05;
      идентификатор        - E863BA814540018D08AA519101C2ABCE329C32E4
      степень доверия      - ultimate;
      имя                  - Malvina Karabasovna;
      e-mail               - malvina@mail.

7.3.2.3. Если смущает ПРЕДУПРЕЖДЕНИЕ "...WARNING: unsafe permissions on homedir..." добавьте опцию [--no-permission-warning].


example malvina > gpg --homedir /tmp/dir_malvina --no-permission-warning --list-public-keys 
/tmp/dir_malvina/pubring.kbx
-------------------------------------------
pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid           [ultimate] Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]


7.3.2.4. Применив команду [--list-secret-keys] смотрим список секретных ключей.


example malvina > gpg --homedir /tmp/dir_malvina --no-permission-warning --list-secret-keys 
/tmp/dir_malvina/pubring.kbx
-------------------------------------------
sec   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid           [ultimate] Malvina Karabasovna <malvina@mail>
ssb   rsa3072 2013-04-06 [E] [expires: 2015-04-05]


7.3.2.5. Применив команду [--full-generate-key] запустим создание пары ключей в полном режиме (кстати если были внимательны она предлагалась ранее). Незабываем про опциию [--home-dir] указывая домашний каталог [dir_buratino].


example buratino > gpg --homedir /tmp/dir_buratino --full-generate-key
gpg: WARNING: unsafe permissions on homedir '/tmp/dir_buratino'
gpg *
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

gpg: keybox '/tmp/dir_buratino/pubring.kbx' created
Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? 1
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (3072) 4096
Requested keysize is 4096 bits
Please specify how long the key should be valid.
         0 = key does not expire
      <n>  = key expires in n days
      <n>w = key expires in n weeks
      <n>m = key expires in n months
      <n>y = key expires in n years
Key is valid for? (0) 1m
Key expires at Sun 05 May 2013 20:13:00 AM
Is this correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: Buratino
Email address: buratino@mail
Comment: free boy
You selected this USER-ID:
    "Buratino (free boy) <buratino@mail>"

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: /tmp/dir_buratino/trustdb.gpg: trustdb created
gpg: key DC3CCB8F4B75702C marked as ultimately trusted
gpg: directory '/tmp/dir_buratino/openpgp-revocs.d' created
gpg: revocation certificate stored as '/tmp/dir_buratino/openpgp-revocs.d/744331AE1D8C709352A197FEDC3CCB8F4B75702C.rev'
public and secret key created and signed.

pub   rsa4096 2013-04-06 [SC] [expires: 2013-05-05]
      744331AE1D8C709352A197FEDC3CCB8F4B75702C
uid                      Buratino (free boy) <buratino@mail>
sub   rsa4096 2013-04-06 [E] [expires: 2013-05-05]


    В полном режиме получаем возможность: выбрать алгоритм шифрования, увеличить длину ключа вместо 3072 до максимально реализованной в программе 4096, указать срок годности пары ключей в днях, неделях, месяцах, годах. И в итоге получаем еще одну пару ключей.


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    +-----+----------+------------------------------------------+
 

7.3.2.6. Проверяем содержимое каталога [dir_buratino].


example buratino > ls -l -R /tmp/dir_buratino/
/tmp/dir_buratino/:
total 20
drwx------ 2 root root 4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root 4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root 2489 Apr  6 20:13 pubring.kbx
-rw------- 1 root root   32 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root 1240 Apr  6 20:13 trustdb.gpg

/tmp/dir_buratino/openpgp-revocs.d:
total 4
-rw------- 1 root root 1810 Apr  6 20:13 744331AE1D8C709352A197FEDC3CCB8F4B75702C.rev

/tmp/dir_buratino/private-keys-v1.d:
total 8
-rw------- 1 root root 2055 Apr  6 20:13 48E3F07F8DF3DE86B57EC2DAF1C8484DFFF4B098.key
-rw------- 1 root root 2071 Apr  6 20:13 AD1D5B4698CF08C8D6BFFADE7D61DE371BD05693.key


7.3.2.7. Применив команду [--list-public-keys] смотрим список открытых ключей.


example buratino > gpg --homedir /tmp/dir_buratino --no-permission-warning --list-public-keys 
gpg: checking the trustdb
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
gpg: next trustdb check due at 2013-05-05
/tmp/dir_buratino/pubring.kbx
--------------------------------------------
pub   rsa4096 2013-04-06 [SC] [expires: 2013-05-05]
      744331AE1D8C709352A197FEDC3CCB8F4B75702C
uid           [ultimate] Buratino (free boy) <buratino@mail>
sub   rsa4096 2013-04-06 [E] [expires: 2013-05-05]


    Здесь стоит обратить внимание на сообщение "gpg: next trustdb check due at 2013-05-05".

7.3.2.8. Применив команду [--list-secret-keys] смотрим список секретных ключей.


example buratino > gpg --homedir /tmp/dir_buratino --no-permission-warning --list-secret-keys 
/tmp/dir_buratino/pubring.kbx
--------------------------------------------
sec   rsa4096 2013-04-06 [SC] [expires: 2013-05-05]
      744331AE1D8C709352A197FEDC3CCB8F4B75702C
uid           [ultimate] Buratino (free boy) <buratino@mail>
ssb   rsa4096 2013-04-06 [E] [expires: 2013-05-05]


7.3.3. Экспорт ключа.

    Процесс создания (дубликата) ключа для передачи.

7.3.3.0. Применив команду [--export] совершим экспорт открытого ключа. По умолчанию ключ выводится на экран, поэтому добавим опцию [--output] с указанием имени файла [malvina_bin.key] сохраненим открытый ключ в бинарном формате (если попытаться вывести на экран бинарное содержимое - будет непредсказуемо весело). Не зацикливайтесь на названии файла.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --export --output /tmp/dir_malvina/malvina_bin.key
gpg: writing to '/tmp/dir_malvina/malvina_bin.key'


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
    +-----+----------+------------------------------------------+  |
                                                                   |
    [ file: malvina_bin.key ]<-------------------------------------+


7.3.3.1. Посмотрим на содержимое файла [malvina_bin.key].


example malvina > xxd -g 1 /tmp/dir_malvina/malvina_bin.key 
00000000: 99 01 8d 04 51 5f 2e 67 01 0c 00 c3 15 ef f1 2f  ....Q_.g......./
00000010: c9 1a 6b ec 4e 19 38 79 74 a2 17 5b 2b d4 d4 e3  ..k.N.8yt..[+...
00000020: 33 20 64 10 1e 96 21 26 6f fe 73 de cc be 9f bb  3 d...!&o.s.....
00000030: 23 f1 47 76 14 d0 ef 7c aa 83 c6 51 ef b5 24 68  #.Gv...|...Q..$h
00000040: 70 39 ee 26 02 0f 35 16 d1 00 4c c5 74 e7 34 bf  p9.&..5...L.t.4.
00000050: 91 93 4e 32 00 bf 84 8b 0c cd ce f7 ac 8f d3 37  ..N2...........7
00000060: 4e a6 d5 3a bc 0a ab d4 8b d0 c6 fd 9c df 15 af  N..:............
00000070: 32 2b d5 83 ed dd 72 de c2 4b 8c da 37 f2 cd 09  2+....r..K..7...
00000080: 49 f8 98 84 d6 73 fc c1 78 97 20 c8 51 82 44 4b  I....s..x. .Q.DK
00000090: 8f e1 45 5b da 3c de 2d 9c 4f 58 56 64 61 2f 91  ..E[.<.-.OXVda/.
000000a0: c9 7f de 89 d5 19 e5 34 22 14 55 f1 fe 26 e4 1e  .......4".U..&..
000000b0: 9a 4d 4f b3 82 d3 8c 28 98 2e ae ca 4e 48 bd 14  .MO....(....NH..
000000c0: 09 cf 34 f9 7c ed ff fa 00 85 ac 02 dd 81 ad 70  ..4.|..........p
000000d0: eb 6c bf d5 c4 b4 5b 2a 70 b3 60 31 f1 80 4d dc  .l....[*p.`1..M.
000000e0: 7d 21 46 4b c1 2b ec 4b d5 60 3c 86 a0 5b d9 aa  }!FK.+.K.`<..[..
000000f0: 53 61 32 64 57 d7 47 ae 50 a1 35 9f 80 eb 24 8f  Sa2dW.G.P.5...$.
00000100: a4 1b d7 97 c8 bb 1f 16 c4 25 01 56 cb 67 54 a9  .........%.V.gT.
00000110: b1 04 ca 4f 00 61 95 13 01 c5 4b 1f c2 60 c1 90  ...O.a....K..`..
00000120: 91 04 b6 ec a7 d6 75 ae 5a e1 1a b1 aa 80 67 5f  ......u.Z.....g_
00000130: 61 15 5e bf 1a d8 49 6a 9f 7b 60 1a 08 cf 09 d9  a.^...Ij.{`.....
00000140: c1 ad a2 bc 0a c0 b5 bf 6e a9 26 90 b5 a6 0e 0e  ........n.&.....
00000150: ec 06 ed 1e d5 73 59 23 e5 7e 06 41 52 5c 5c 95  .....sY#.~.AR\\.
00000160: 6d 87 14 45 aa 81 c4 58 12 89 6c 75 f0 af 0b 5e  m..E...X..lu...^
00000170: be ba 90 2d ae f4 ca 13 0e 07 51 8d 5f d0 7a 5f  ...-......Q._.z_
00000180: 70 97 a1 85 b0 da a8 d7 ee 61 11 00 11 01 00 01  p........a......
00000190: b4 22 4d 61 6c 76 69 6e 61 20 4b 61 72 61 62 61  ."Malvina Karaba
000001a0: 73 6f 76 6e 61 20 3c 6d 61 6c 76 69 6e 61 40 6d  sovna <malvina@m
000001b0: 61 69 6c 3e 89 01 d4 04 13 01 0a 00 3e 16 21 04  ail>........>.!.
000001c0: 1b b8 8b 75 09 ee 24 25 e9 d7 f9 78 3c 21 02 ff  ...u..$%...x<!..
000001d0: 87 68 f6 f1 05 02 51 5f 2e 67 02 1b 03 05 09 03  .h....Q_.g......
000001e0: c2 67 00 05 0b 09 08 07 02 06 15 0a 09 08 0b 02  .g..............
000001f0: 04 16 02 03 01 02 1e 01 02 17 80 00 0a 09 10 3c  ...............<
00000200: 21 02 ff 87 68 f6 f1 20 79 0b ff 49 da de 63 6d  !...h.. y..I..cm
00000210: 39 a8 5d 47 4b c7 07 41 06 37 d4 68 f3 84 7a 33  9.]GK..A.7.h..z3
00000220: cc 70 28 5b f5 3f 6d 6f 42 1d bc ae 39 ec e9 e8  .p([.?moB...9...
00000230: 41 f1 e0 75 af 90 21 74 bb df 16 5d 82 57 42 7c  A..u..!t...].WB|
00000240: 79 54 a3 0d 92 a9 e6 8f 0d d8 49 a2 82 4c 20 18  yT........I..L .
00000250: 70 82 a4 98 78 cc ab 72 96 7b 70 a0 bc e8 0a 40  p...x..r.{p....@
00000260: f2 56 5c 0f e9 9b 37 b3 0f 96 3c 5b 68 d0 01 71  .V\...7...<[h..q
00000270: 25 cb 04 7b 3b a0 b8 95 91 7e 6c fd 58 24 c4 ed  %..{;....~l.X$..
00000280: 37 14 bb 4f d2 93 59 5b 12 76 5f 95 7c d3 10 df  7..O..Y[.v_.|...
00000290: 4e cb 42 a7 b1 44 f2 47 05 3a 64 c2 c2 82 14 bf  N.B..D.G.:d.....
000002a0: 86 de 21 09 59 9d ac 51 01 22 93 f3 e4 7c bb 36  ..!.Y..Q."...|.6
000002b0: be 13 77 f9 4f 24 b3 58 5e 21 98 09 9a ef 7c 8e  ..w.O$.X^!....|.
000002c0: f2 72 1e 52 0a 4c 79 d6 7d a3 2b 16 cb db a9 47  .r.R.Ly.}.+....G
000002d0: ce 7e 1e b5 a2 d9 7d 85 34 ec 93 9d 2f fe f2 17  .~....}.4.../...
000002e0: c3 3f ec 8c dd 99 3f 71 61 cf 42 17 8e 56 da 4d  .?....?qa.B..V.M
000002f0: 4a 27 1b d3 42 ef a4 ac bf fa e8 b2 13 4f 95 d4  J'..B........O..
00000300: d1 ed 04 03 8b 96 a0 15 86 bd 0f 6b d7 38 6c 06  ...........k.8l.
00000310: 41 af c6 fc 7a 12 fd 21 45 0b 3c 9a 7f b3 fe ff  A...z..!E.<.....
00000320: 69 39 fe d7 ad 45 e3 7d 06 32 43 50 bd d9 ac aa  i9...E.}.2CP....
00000330: 8d 00 00 df 9f c4 26 66 61 af ff 7d 7c b8 40 13  ......&fa..}|.@.
00000340: bd fe e3 db d7 44 29 7f 9d 6a 4f d1 30 76 2d 1a  .....D)..jO.0v-.
00000350: 9c 1a 35 56 a6 92 94 4b 55 05 96 28 cc e6 9f 92  ..5V...KU..(....
00000360: c8 6e 9d 94 dd 36 32 56 78 03 e0 5e ab f1 2a 1e  .n...62Vx..^..*.
00000370: 7a 89 9e bc c6 b2 31 4b 8c 1e 04 cc 4c ed 0c c2  z.....1K....L...
00000380: 36 ca 4c 4c 3e 8d 77 5c 18 ca fa b9 01 8d 04 51  6.LL>.w\.......Q
00000390: 5f 2e 67 01 0c 00 b0 86 5b 26 e1 06 67 85 09 2a  _.g.....[&..g..*
000003a0: b1 f4 89 cc ce 85 ba da 20 5f 40 91 e9 d3 c4 9a  ........ _@.....
000003b0: a1 a1 4a 05 2a d6 db 47 5f 6a 3f 4d 5e d6 53 ac  ..J.*..G_j?M^.S.
000003c0: e0 1c 44 ff 68 4a a5 f6 02 c0 ab 16 42 f8 64 18  ..D.hJ......B.d.
000003d0: 07 2c f7 b2 6e de 4e 30 b7 a8 bf 8b 9f 0b 74 8b  .,..n.N0......t.
000003e0: 08 41 21 4d 01 b9 61 d1 cd d7 d2 0a fb 7d ba e5  .A!M..a......}..
000003f0: c9 6d 7f 4d 99 f2 30 33 63 14 d5 ce 1b ff fa 83  .m.M..03c.......
00000400: 26 89 d4 a0 c1 04 52 d7 fb 8c 53 b1 ef ee 9f 86  &.....R...S.....
00000410: 39 04 78 24 53 4f b9 a7 11 9f 80 ec 53 53 2c 7f  9.x$SO......SS,.
00000420: a5 6d da ad ea 36 16 b2 e5 e1 5c 7e 7b d9 14 94  .m...6....\~{...
00000430: 1d f0 99 0a 98 29 14 7d b8 60 0c 38 6b 67 03 8b  .....).}.`.8kg..
00000440: 77 82 dd be 99 b2 3c d1 03 8a 2b f8 74 d0 1e 2d  w.....<...+.t..-
00000450: db 3f 5d 09 4a a3 78 df 37 5c de 4c 3b 48 25 d4  .?].J.x.7\.L;H%.
00000460: e0 f4 4a 83 80 d6 fe 46 36 5a 7c b5 41 9a f8 98  ..J....F6Z|.A...
00000470: 38 5f 0e 17 aa 25 47 c9 67 5f 84 71 31 e7 90 c9  8_...%G.g_.q1...
00000480: 53 40 99 9a 3c fc b0 55 b7 f8 f6 7c 58 99 4a a5  S@..<..U...|X.J.
00000490: 0a 91 79 d4 39 ed fc 22 3f cd e4 d5 3b a0 dc d9  ..y.9.."?...;...
000004a0: 82 7e 0b 39 7a d6 b8 7f c0 c0 18 25 f8 69 32 b4  .~.9z......%.i2.
000004b0: 36 3f f9 c5 e2 56 8a 26 b5 d8 2a 07 39 46 7d 29  6?...V.&..*.9F})
000004c0: 99 9c 64 13 8c fd 0b 26 73 4a f8 e8 5b 5f 60 5c  ..d....&sJ..[_`\
000004d0: ff cc 4a d9 1c 55 34 12 9b b0 4b 59 86 00 7e 48  ..J..U4...KY..~H
000004e0: fd 56 86 f6 d1 84 d9 fd f6 89 60 c0 8e c4 fe da  .V........`.....
000004f0: f0 dc be 22 2e 43 bd 91 ab 44 a3 00 0e 8d ab 28  ...".C...D.....(
00000500: bf b2 bc 2c ba a3 3a 6c 74 ca b8 4d 9f 30 69 18  ...,..:lt..M.0i.
00000510: b6 36 ef c7 e5 eb 00 11 01 00 01 89 01 bc 04 18  .6..............
00000520: 01 0a 00 26 16 21 04 1b b8 8b 75 09 ee 24 25 e9  ...&.!....u..$%.
00000530: d7 f9 78 3c 21 02 ff 87 68 f6 f1 05 02 51 5f 2e  ..x<!...h....Q_.
00000540: 67 02 1b 0c 05 09 03 c2 67 00 00 0a 09 10 3c 21  g.......g.....<!
00000550: 02 ff 87 68 f6 f1 3b 2c 0b fd 12 8e c0 7a 8b 9e  ...h..;,.....z..
00000560: a4 50 34 72 42 b6 ae dc 6f c2 e3 7a 46 01 d3 06  .P4rB...o..zF...
00000570: e6 35 46 f1 3a 58 b1 fa e4 d5 c1 7c 9a 97 b0 d2  .5F.:X.....|....
00000580: c7 d3 49 6a 82 26 f7 b7 39 81 0c 61 c7 c3 b1 9e  ..Ij.&..9..a....
00000590: 3b dc 2a 57 4d 4e d9 b8 98 b5 cc df d7 cf b1 9a  ;.*WMN..........
000005a0: b1 18 9d 97 a0 64 ee 42 18 79 79 a8 bf b4 26 67  .....d.B.yy...&g
000005b0: e4 af a2 73 7c f8 a3 80 b3 f4 7a ad c4 62 4c d6  ...s|.....z..bL.
000005c0: a5 ec 31 97 1b f3 c6 1a 0e b5 d7 2a c1 1e 07 e7  ..1........*....
000005d0: 14 07 95 48 ff 1f e0 b1 f1 89 f1 65 68 e2 e6 47  ...H.......eh..G
000005e0: a7 7e d5 16 32 7a 8e 0a fe e1 0f e4 61 34 38 e9  .~..2z......a48.
000005f0: e7 aa 13 34 88 78 47 91 31 0d a9 9d 47 bf b1 7f  ...4.xG.1...G...
00000600: b5 43 28 7b 40 0e a0 fd c8 f5 3b 4d e7 6a 92 25  .C({@.....;M.j.%
00000610: 2c 71 a9 d8 28 a1 2f e4 09 34 e3 8a 58 fa 80 72  ,q..(./..4..X..r
00000620: 1c f8 f9 af 59 ca 09 e8 49 2d dc bf a6 59 5b 7b  ....Y...I-...Y[{
00000630: 2a c6 91 b6 84 f4 4a 21 c1 e3 f0 ac 1a ec 73 59  *.....J!......sY
00000640: 9b 4c 7c 11 50 83 6f 2c 9c c3 0a 47 95 68 d3 8e  .L|.P.o,...G.h..
00000650: 90 3a b6 96 ff f5 4e 55 d9 dc e0 cf f3 ed c4 12  .:....NU........
00000660: 96 1e a0 09 dc b2 82 1a 6e 66 86 50 2e 35 22 3b  ........nf.P.5";
00000670: 58 06 0c 35 51 11 5b 7c 0d 4d b8 64 45 34 37 d6  X..5Q.[|.M.dE47.
00000680: 63 c0 f5 8b 6a c1 f4 a1 a3 04 9e 04 0a 4d 8d a0  c...j........M..
00000690: be fe 03 b7 17 ea c6 90 f6 93 89 98 d8 64 1a 0f  .............d..
000006a0: 82 53 02 e8 d0 f1 0c 5f 79 c7 16 e5 79 62 64 eb  .S....._y...ybd.
000006b0: 42 32 db fc a2 b0 d9 85 3c 90 c8 81 d5 04 5b 07  B2......<.....[.
000006c0: 63 f0 13 1b 89 82 a1 b8 34 08 38 f4 af a1 d4 65  c.......4.8....e
000006d0: 6b c1 aa 27 55 87 90 60 87 76                    k..'U..`.v


7.3.3.2. Добавив опцию [--armor] всегда можно получить текстовый вариант ascii формат.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --export malvina@mail --armor
gpg: writing to stdout
-----BEGIN PGP PUBLIC KEY BLOCK-----

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
Y/ATG4mCobg0CDj0r6HUZWvBqidVh5Bgh3Y=
=07hM
-----END PGP PUBLIC KEY BLOCK-----


7.3.3.3. Добавив опцию [--output] с указанием имени файла [malvina_ascii.key] сохраним открытый ключ в ascii формате.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --export malvina@mail --armor --output /tmp/dir_malvina/malvina_ascii.key
gpg: writing to '/tmp/dir_malvina/malvina_ascii.key'


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
    +-----+----------+------------------------------------------+  |
                                                                   |
    [ file: malvina_bin.key ]                                      |
    [ file: malvina_ascii.key ]<-----------------------------------+


7.3.3.4. Посмотрим на содержимое файла [malvina_ascii.key].


example malvina > cat /tmp/dir_malvina/malvina_ascii.key 
-----BEGIN PGP PUBLIC KEY BLOCK-----

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
Y/ATG4mCobg0CDj0r6HUZWvBqidVh5Bgh3Y=
=07hM
-----END PGP PUBLIC KEY BLOCK-----


7.3.3.5. Проверяем содержимое каталога [dir_malvina].


example malvina > ls -l /tmp/dir_malvina
total 28
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.key
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.key
drwx------ 2 root root 4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root 4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root 1976 Apr  6 20:13 pubring.kbx
-rw------- 1 root root   32 Apr  6 20:13 pubring.kbx~
-rw-r--r-- 1 root root 1280 Apr  6 20:13 trustdb.gpg


7.3.3.6. Приостановимся и задумаемся, зачем реализовано два формата файлов бинарный и ascii. Однозначно бинарный формат должен занимать меньше места (при шифровании все намного веселее ;) ), компактнее, быстрее вылетает и прилетает при нынешнем технологических возможностях уже не впечатляет, но ровно до тех пор пока не обрастете ключами. Формат ascii реализован исключительно печатными символами, что позволяет легче распространить и опубликовать (да-да зубилом на камне).

7.3.3.7. Применив команду [--export] совершим экспорт открытого ключа. Добавим опцию [--output] с указанием имени файла [buratino_bin.key] сохраненим открытый ключ в бинарном формате.


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --export --output /tmp/dir_buratino/buratino_bin.key
gpg: writing to '/tmp/dir_buratino/buratino_bin.key'


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |--+
    +-----+----------+------------------------------------------+  |
                                                                   |
    [ file: buratino_bin.key ]<------------------------------------+


7.3.3.8. Посмотрим на содержимое файла [buratino_bin.key]. Обращаем внимание на возросшую длину файла и ключа.


example buratino > xxd -g 1 /tmp/dir_buratino/buratino_bin.key 
00000000: 99 02 0d 04 51 5f 2d ef 01 10 00 a9 83 d2 0e 63  ....Q_-........c
00000010: 93 b9 df ba 14 c3 7e ed 90 94 84 57 86 2f 91 4f  ......~....W./.O
00000020: cc d0 95 14 b9 fd 3a 2e 2a 7e 33 16 cd 6f c7 b7  ......:.*~3..o..
00000030: 71 e0 b6 c8 75 c9 df 3a c7 87 3b e0 50 74 28 22  q...u..:..;.Pt("
00000040: 93 69 35 47 9b 82 12 24 bc 4a 39 36 f0 d2 8b e3  .i5G...$.J96....
00000050: df f8 4b dd 20 a5 7b 2a 04 3a 4f 21 cc d3 ab ad  ..K. .{*.:O!....
00000060: fd 7e a5 2c 33 67 91 1e e8 21 8a ec 20 8d 97 50  .~.,3g...!.. ..P
00000070: 38 0d ca 20 fb 2e 4b f3 09 cd 9d 0a 34 fc f5 17  8.. ..K.....4...
00000080: a6 14 30 0b 11 fd 9c 81 c1 e0 48 f8 e7 41 ba 5f  ..0.......H..A._
00000090: 0d 6f 46 44 53 77 f9 7b b0 da d1 19 55 06 07 48  .oFDSw.{....U..H
000000a0: 69 c5 7a fa 03 3b d1 37 00 e6 41 48 55 96 8c 87  i.z..;.7..AHU...
000000b0: bf d6 13 b7 6f 00 aa e8 57 cd 26 ac df e1 6b 77  ....o...W.&...kw
000000c0: dc 58 1c 99 4a 60 75 af d8 9d aa 5a f9 c1 90 44  .X..J`u....Z...D
000000d0: 88 b3 6a 95 9c 43 8a 8d 40 42 02 b4 01 91 b8 b4  ..j..C..@B......
000000e0: 7f 93 86 95 9b f3 06 45 ea a7 2a 46 f5 2b ca 5c  .......E..*F.+.\
000000f0: 06 dd 07 4e f4 b6 37 68 d8 2e 0d 73 c8 75 9a b6  ...N..7h...s.u..
00000100: d2 93 10 67 31 a0 7f 0c 4a 74 74 bd 67 55 e0 28  ...g1...Jtt.gU.(
00000110: ce 40 32 ec b8 ae f6 0b 3a cf 12 51 1d a9 c6 79  .@2.....:..Q...y
00000120: 7e 0c 01 ca 13 26 cf 1f fb 15 de dd c4 02 bf 08  ~....&..........
00000130: 92 64 61 fa d6 5d 7b 56 ff 2c e8 c3 4f d0 0a 37  .da..]{V.,..O..7
00000140: c3 89 62 7b 9c 3b e2 d8 f7 72 9a f6 be 5b 14 77  ..b{.;...r...[.w
00000150: e2 8e d6 b0 94 68 a1 7b 37 9f d8 25 57 66 5b af  .....h.{7..%Wf[.
00000160: 5c 55 a2 f1 f9 8e 63 4b df 1f 26 2a 42 d6 05 1a  \U....cK..&*B...
00000170: b1 2c 7e 64 cc 05 b2 09 91 2b 94 87 a2 74 71 84  .,~d.....+...tq.
00000180: f1 b9 a8 6a 8f 6a 45 4b d8 5e 36 5a 4c 13 d8 f9  ...j.jEK.^6ZL...
00000190: e9 ac fa 4c ff b0 1d 7b 98 bb c1 8d 10 c9 63 b7  ...L...{......c.
000001a0: 83 31 1c aa 77 1c 2e 27 09 6a 53 41 78 23 e7 8a  .1..w..'.jSAx#..
000001b0: fd 12 58 1d 5e 73 19 0a 35 4a 2d 4b 48 95 7b 0a  ..X.^s..5J-KH.{.
000001c0: 20 23 c2 cb a8 b8 b4 4f cb 56 36 dc a3 e7 0d f6   #.....O.V6.....
000001d0: 8f 9c ac af 54 2d d5 43 d0 b3 56 d3 36 e3 e8 bb  ....T-.C..V.6...
000001e0: 6f 56 ca 5a 49 1c de 57 5a d0 8a f3 df c9 7f 0c  oV.ZI..WZ.......
000001f0: a4 5d 89 b9 0c 1c e0 0d be 98 9c 25 52 3d bf 73  .].........%R=.s
00000200: 89 bf 6d 73 cd 78 57 35 e1 e2 cb 00 11 01 00 01  ..ms.xW5........
00000210: b4 23 42 75 72 61 74 69 6e 6f 20 28 66 72 65 65  .#Buratino (free
00000220: 20 62 6f 79 29 20 3c 62 75 72 61 74 69 6e 6f 40   boy) <buratino@
00000230: 6d 61 69 6c 3e 89 02 54 04 13 01 0a 00 3e 16 21  mail>..T.....>.!
00000240: 04 9e 02 90 f4 83 62 cd b9 99 e5 7c f0 b2 a3 f8  ......b....|....
00000250: 84 16 20 53 60 05 02 51 5f 2d ef 02 1b 03 05 09  .. S`..Q_-......
00000260: 00 27 8d 00 05 0b 09 08 07 02 06 15 0a 09 08 0b  .'..............
00000270: 02 04 16 02 03 01 02 1e 01 02 17 80 00 0a 09 10  ................
00000280: b2 a3 f8 84 16 20 53 60 8d 78 0f ff 4c a6 32 24  ..... S`.x..L.2$
00000290: 74 3c 7a 2f 98 1a 17 3a 70 a5 06 52 1a 01 5b 34  t<z/...:p..R..[4
000002a0: bd 03 3c 67 d0 88 71 df b0 c8 09 9b 4a 94 e6 d6  ..<g..q.....J...
000002b0: 74 8b c3 9f 15 3a 9a 84 f1 c1 af 7b b8 1d a2 d9  t....:.....{....
000002c0: 96 8b 6f 65 7c 88 6e e8 b7 61 7e 63 b1 31 d4 6d  ..oe|.n..a~c.1.m
000002d0: 2a 26 b5 65 b5 d3 c7 e9 ec bb da 02 e0 70 fb 8a  *&.e.........p..
000002e0: df 1b 3c 49 3d 31 ec 47 14 5e cd 9e 19 0b 33 d9  ..<I=1.G.^....3.
000002f0: ba 9b bc 95 33 33 ee ef 68 65 23 00 0b 7d ed e9  ....33..he#..}..
00000300: 10 c1 89 3b 7a 97 9b 26 5b a7 86 63 47 d0 6c 08  ...;z..&[..cG.l.
00000310: 79 05 8b b8 75 61 c9 d2 9c c4 09 5f bf 50 64 6b  y...ua....._.Pdk
00000320: df d3 04 40 0b 0c 3d a3 55 14 35 88 c2 4b 51 72  ...@..=.U.5..KQr
00000330: 6e 72 19 90 bd 2a 6e 5b a0 10 e6 5c 0c f4 33 3c  nr...*n[...\..3<
00000340: 08 3f 2f b0 f2 c6 f3 62 6f 06 50 3e 9b 89 c0 e7  .?/....bo.P>....
00000350: e2 62 82 d3 6a f3 a3 b2 cc a5 a4 19 b8 fe cb 33  .b..j..........3
00000360: 4b b3 36 d6 4a 0e 21 b3 26 f6 38 5d da 11 0d b1  K.6.J.!.&.8]....
00000370: bd 28 40 75 1c ab ab 88 28 b9 c1 62 04 32 a9 ae  .(@u....(..b.2..
00000380: f2 d8 de d7 da ad 2e c3 a1 9b 93 63 96 35 6d a3  ...........c.5m.
00000390: 88 0c 91 ab 02 26 a9 af bf 63 f7 ab 9f 4d 05 9b  .....&...c...M..
000003a0: 79 bf b3 de c5 d3 88 28 16 6b 1a 25 1b 94 f2 af  y......(.k.%....
000003b0: 03 46 42 7c 45 5a 45 53 30 78 97 63 ca 57 b0 1e  .FB|EZES0x.c.W..
000003c0: b4 ac c8 87 0a ff ea 2e ae f4 0f c2 5a 0e 16 a5  ............Z...
000003d0: f2 e6 99 f2 e1 af 34 32 12 3f c3 88 26 2b 60 59  ......42.?..&+`Y
000003e0: 9e f0 8c 8c 1d c7 4c 98 98 4a f9 18 da 1e 9b 22  ......L..J....."
000003f0: 0a 16 3c 93 93 8e f3 ff f6 9b d7 9e 6f aa 72 68  ..<.........o.rh
00000400: bf 4f 3a 45 ae 96 56 97 73 c2 ef 80 03 b1 8f 7a  .O:E..V.s......z
00000410: 4b c9 5c c5 79 60 a1 16 94 db 6a d4 bb 4f d3 81  K.\.y`....j..O..
00000420: e3 0d 05 f9 c1 77 1f 12 47 08 ec 97 7e ff 83 62  .....w..G...~..b
00000430: c9 ff 94 ce f5 4d aa b4 8e 03 dc ea a9 55 8f c8  .....M.......U..
00000440: 1d 9b 3b bb 58 0b 50 f7 2a a4 13 f5 f6 f6 9d af  ..;.X.P.*.......
00000450: f8 01 66 e1 ad 4e 4b ea f3 c2 ca aa 70 36 c7 6d  ..f..NK.....p6.m
00000460: f4 81 1f 3c 9d 6b 28 f3 2a c0 14 f6 f4 db 49 c3  ...<.k(.*.....I.
00000470: 46 99 25 5d d5 49 44 c9 ba 35 a4 4d b9 a3 50 d2  F.%].ID..5.M..P.
00000480: b0 1a 45 e8 c8 6e 71 90 a8 c0 bc b1 b9 02 0d 04  ..E..nq.........
00000490: 51 5f 2d ef 01 10 00 fb 0e 69 3a 69 b0 98 44 c2  Q_-......i:i..D.
000004a0: 9a dc ad 29 b0 49 1c 43 e8 2e 98 4d 0b ce 6b 7f  ...).I.C...M..k.
000004b0: fa 58 41 83 90 9b dd 1c cf 00 04 7b 4e a4 c2 d3  .XA........{N...
000004c0: ca f5 7b 5f 93 34 01 c4 49 58 92 0a a5 52 95 04  ..{_.4..IX...R..
000004d0: 29 85 0e e8 45 3c ae 8f a7 d7 43 12 83 a6 51 b6  )...E<....C...Q.
000004e0: 54 d2 78 81 c4 2d a6 43 8d c2 64 63 90 5a 47 fc  T.x..-.C..dc.ZG.
000004f0: e4 8d b3 7f fd 9b 52 2c 79 7a 19 24 04 cd 74 84  ......R,yz.$..t.
00000500: 64 1e 00 9e 30 92 6b e1 dc 99 33 c6 08 54 ae 3e  d...0.k...3..T.>
00000510: 06 79 62 bd ec 02 0d 37 6d bc 44 06 74 2f ec 1d  .yb....7m.D.t/..
00000520: ff 74 64 d4 96 6c 70 ab ed b5 78 2b 9a ed d0 b0  .td..lp...x+....
00000530: 61 bc ef 3a a2 45 8b f4 03 41 d9 4c a7 bc 77 f6  a..:.E...A.L..w.
00000540: 5f aa 98 f8 67 b3 da a5 cd 45 a4 eb 6c 41 8d 87  _...g....E..lA..
00000550: 5f 53 ce af 13 46 22 03 6e e3 08 13 93 dd 31 0b  _S...F".n.....1.
00000560: 76 a0 9f 87 26 ea 5e 7b a8 e9 d6 22 89 5a 83 4b  v...&.^{...".Z.K
00000570: 78 9f 3b 63 db ed bb ae 51 2a 39 d2 05 20 e1 6c  x.;c....Q*9.. .l
00000580: f6 cd de 6c d5 d0 32 8e 7b b9 37 a2 9e bb e3 0e  ...l..2.{.7.....
00000590: f4 6e 13 d9 a7 f2 9a c2 07 e8 66 21 40 19 6d d3  .n........f!@.m.
000005a0: cc 9d 80 ec 89 76 4a fe 74 dd ca ff 78 58 f5 99  .....vJ.t...xX..
000005b0: 19 52 c0 67 47 ea 72 11 00 b2 50 8e 3a ac 08 cd  .R.gG.r...P.:...
000005c0: 94 3f 22 f4 0b 50 9b 16 ea d9 92 6e ab aa b4 21  .?"..P.....n...!
000005d0: 74 4d 14 6e 70 15 54 bf af b5 98 70 0d 32 c0 47  tM.np.T....p.2.G
000005e0: 9a 28 31 2f bc 21 63 cb a4 87 37 f3 4f 3c d7 aa  .(1/.!c...7.O<..
000005f0: 50 f2 0d f3 cf 3c 55 e2 0c cc b7 3c e4 41 fa 8e  P....<U....<.A..
00000600: e4 15 c0 62 d7 99 66 45 fc 3f e5 0c 05 f5 f2 a7  ...b..fE.?......
00000610: 46 e9 f1 48 a9 fb 4d df e9 b6 dd e0 d8 43 2c cb  F..H..M......C,.
00000620: ee f7 d5 b9 6d 68 8c ed 0d 41 d5 c6 ea 15 50 a7  ....mh...A....P.
00000630: 00 99 19 18 49 0e 0b d0 3c 80 bb 7b 74 fd e4 f2  ....I...<..{t...
00000640: be 63 5e b2 9f 1f 8f e9 42 65 f5 00 85 a8 00 45  .c^.....Be.....E
00000650: e0 ef e8 a2 95 31 fe cb 5b aa 7c 07 b3 8f f8 02  .....1..[.|.....
00000660: c1 e3 76 6d 69 de 3f 0c 41 07 9a ff aa 0d 30 d2  ..vmi.?.A.....0.
00000670: fe e6 e6 0b f9 ee 0e 04 2d 5a d4 f4 4d a8 cc a9  ........-Z..M...
00000680: 5a 91 03 59 40 e8 db 88 9c 53 e3 26 c8 7d 4e 68  Z..Y@....S.&.}Nh
00000690: 14 c9 25 d7 d4 45 29 00 11 01 00 01 89 02 3c 04  ..%..E).......<.
000006a0: 18 01 0a 00 26 16 21 04 9e 02 90 f4 83 62 cd b9  ....&.!......b..
000006b0: 99 e5 7c f0 b2 a3 f8 84 16 20 53 60 05 02 51 5f  ..|...... S`..Q_
000006c0: 2d ef 02 1b 0c 05 09 00 27 8d 00 00 0a 09 10 b2  -.......'.......
000006d0: a3 f8 84 16 20 53 60 7a c3 10 00 9c 71 55 e9 46  .... S`z....qU.F
000006e0: 8a 3b 8b 7a 50 4c 3f 92 3a cf 1b 89 ec 82 93 38  .;.zPL?.:......8
000006f0: 1f a2 7b 53 08 57 46 4b 95 86 0e 1d 99 91 f7 d7  ..{S.WFK........
00000700: eb ca f4 f7 d5 c3 76 14 fd ea 8b 78 25 63 79 e7  ......v....x%cy.
00000710: 16 44 93 4d 4b 05 6d 27 e5 43 09 98 0e bb aa c4  .D.MK.m'.C......
00000720: 34 de 05 c8 fd ee 5f 55 cb 17 a5 c5 a0 db 9e 12  4....._U........
00000730: bd 1f fc 0b 33 60 18 60 da ca 23 45 62 e2 45 ca  ....3`.`..#Eb.E.
00000740: 90 33 55 71 55 35 e1 6d a5 38 d1 71 f2 5b d3 77  .3UqU5.m.8.q.[.w
00000750: 9e c6 fb 6b d0 32 a1 ac 75 d2 3a 5e 18 fd 01 d9  ...k.2..u.:^....
00000760: 9c 00 8e e1 3d ac a6 80 3d 0c 58 10 30 79 eb ea  ....=...=.X.0y..
00000770: 09 bb bb a7 ed e0 c4 12 8a 97 a1 86 74 d7 03 8f  ............t...
00000780: 7a 59 1a fe 1b 82 16 00 15 8d 89 a4 66 ca 54 49  zY..........f.TI
00000790: e4 d8 cc 9d 15 bb 0f 65 87 46 91 79 a9 fa 98 7e  .......e.F.y...~
000007a0: 28 f3 15 22 7c 31 43 7c 38 cc 71 ea ca 28 86 45  (.."|1C|8.q..(.E
000007b0: a1 40 1c 1a 1a 86 d9 c5 c3 b0 49 08 24 bc 08 02  .@........I.$...
000007c0: f1 3a 84 20 34 ec 15 14 5c 29 29 6d d6 5d 98 3f  .:. 4...\))m.].?
000007d0: 8e 43 42 f0 30 1f b8 f7 9a 4b 1b 97 a7 67 74 7f  .CB.0....K...gt.
000007e0: 2c aa 61 f4 37 1d bb 15 06 86 5f eb 1a cf 3b 10  ,.a.7....._...;.
000007f0: 19 e5 88 10 33 52 a1 b5 92 d6 85 6b ff 78 83 4e  ....3R.....k.x.N
00000800: 2c 77 11 0c 4a 5c 50 f6 da d7 ba da ff b9 7d 24  ,w..J\P.......}$
00000810: df 11 81 60 1a ef 27 4f a5 02 7e ab 01 f7 8c bd  ...`..'O..~.....
00000820: a6 e4 26 3f 02 b6 95 ea 11 3f 65 c8 6a 6c 9f dc  ..&?.....?e.jl..
00000830: 5a bf d6 32 5c 86 29 aa 3a 7b 23 86 4d 1a b6 4b  Z..2\.).:{#.M..K
00000840: a6 fa 0b 39 27 7c 1c e5 99 fc 8a 6c 67 3d b0 8c  ...9'|.....lg=..
00000850: 8a 9a 93 e3 70 46 ac 3f b1 41 95 b6 6c 99 2a c6  ....pF.?.A..l.*.
00000860: d2 54 60 34 d4 15 89 f3 83 05 81 11 8b 23 5d d2  .T`4.........#].
00000870: e9 78 6d 6b fe 24 ee 65 30 bf f2 73 18 cd 08 c4  .xmk.$.e0..s....
00000880: 43 65 53 5a 13 78 98 82 4a c2 83 8b 7c 14 80 a7  CeSZ.x..J...|...
00000890: f1 54 75 96 15 e9 71 2d 21 7d 90 4d af 0e a8 f4  .Tu...q-!}.M....
000008a0: fa 60 b1 9f 68 2c fe d7 90 a1 02 56 c9 c5 87 13  .`..h,.....V....
000008b0: ed 8b 38 86 ef 15 65 90 59 2b a7 cb 6b 9b 9d 30  ..8...e.Y+..k..0
000008c0: 25 ec b9 b1 84 5e 0b 78 36 e7 fd cd 2e a1 a8 a4  %....^.x6.......
000008d0: bb bb 29 c4 7a 16 56 85 dc 5a 57                 ..).z.V..ZW


7.3.3.9. Применив команду [--export] совершим экспорт открытого ключа. Добавим опцию [--armor] для ascii формата. Добавим опцию [--output] с указанием имени файла [buratino_ascii.key] сохраненим открытый ключ в ascii формате.


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --export --armor --output /tmp/dir_buratino/buratino_ascii.key
gpg: writing to '/tmp/dir_buratino/buratino_ascii.key'


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |--+
    +-----+----------+------------------------------------------+  |
                                                                   |
    [ file: buratino_bin.key ]                                     |
    [ file: buratino_ascii.key ]<----------------------------------+


7.3.3.10. Посмотрим на содержимое файла [buratino_ascii.key].


example > cat /tmp/dir_buratino/buratino_ascii.key
-----BEGIN PGP PUBLIC KEY BLOCK-----

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
u7spxHoWVoXcWlc=
=mZsk
-----END PGP PUBLIC KEY BLOCK-----


7.3.3.11. Проверяем содержимое каталога [dir_buratino].


example buratino > ls -l -R /tmp/dir_buratino
/tmp/dir_buratino:
total 28
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.key
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.key
drwx------ 2 root root 4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root 4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root 2489 Apr  6 20:13 pubring.kbx
-rw------- 1 root root   32 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root 1280 Apr  6 20:13 trustdb.gpg

/tmp/dir_buratino/openpgp-revocs.d:
total 4
-rw------- 1 root root 1810 Apr  6 20:13 744331AE1D8C709352A197FEDC3CCB8F4B75702C.rev

/tmp/dir_buratino/private-keys-v1.d:
total 8
-rw------- 1 root root 2055 Apr  6 20:13 48E3F07F8DF3DE86B57EC2DAF1C8484DFFF4B098.key
-rw------- 1 root root 2071 Apr  6 20:13 AD1D5B4698CF08C8D6BFFADE7D61DE371BD05693.key


7.3.3.12. Для тех у кого реально веселая жизнь будет полезна опция [--export-secret-keys].


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --export-secret-keys --armor
gpg: writing to stdout
gpg: key 48E3F07F8DF3DE86B57EC2DAF1C8484DFFF4B098: asking agent for the secret parts
gpg: key AD1D5B4698CF08C8D6BFFADE7D61DE371BD05693: asking agent for the secret parts
-----BEGIN PGP PRIVATE KEY BLOCK-----

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
=aKOp
-----END PGP PRIVATE KEY BLOCK-----


    И зубилом на камне...

7.3.3.13. "...Ваша связка ключей - это ваше сокровище. Вам надо ее защищать, но вы должны быть готовы и уничтожить ее, если случится худшее..." ист.lxf-2017-223.

7.3.4. Доверие прокладке или сучья натура.

    Теперь следует сторонам обменяться открытыми ключами. И с первого взгляда ничего сложного, но именно здесь нужно подойти с предельной осторожностью, ответственностью и пониманием.
    Мы все прекрасно помним, что между Мальвиной и Буратиной под ногами пресмыкался Артемон. Не будем сейчас вдаваться, что именно подсознательно обоюдно манило их к друг другу, хотя удвоенный потенциал был явно на лицо, и каким сучьим естеством движима всякая псина. Видим две стороны жаждущие общения и прокладку не внушающую никакого доверия между ними, как бы сука не виляла своим хвостиком. Можно наивно довериться, чтобы попользоваться собакой, отнести и принести нужное. Но кто мешает псине ссыкливо поджав хвост забиться в свою конуру. Втихаря сгенерить еще одну пару ключей якобы от первой стороны. Выползти из конуры и строя невинные глазки с подлой мордой передать второй стороне. На обратном пути снова забиться в конуру. Сгенерить еще одну пару ключей якобы от второй стороны и вернуть первой стороне. Как минимум этот сучий выродок получает возможность лезть своим собачьим рылом в дело настоящих человеков, и никто не сможет помешать животному в ключевые моменты вносить свои закорючки с далеко идущими последствиями. Мне жаль, но это работает и успешно применяется (и не только здесь - отдельная тема). И виной тому лень человеческая и детская наивность.


 +-----------------------------------------------------------------------------+
 |  malvina                                                                    |
 |  +-----+----------+------------------------------------------+              |
 +->| sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |----+         |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |    |         |
 +->| pub | buratino | CACACACACACACACACACACACACACACACACACACACA |--+ |         |
 |  +-----+----------+------------------------------------------+  | |         |
 |                                                                 | |         |
 +--[ message from malvina ]                                       | |         |
    [ message from buratino ] + [ artemon ]<-----------------------|-+         |
                                                                   |           |
 +-----------------------------------------------------------------|-+         |
 |   artemon-malvina                                               | |         |
 |  +-----+----------+------------------------------------------+  | |         |
 +->| sec | malvina  | FACEFACEFACEFACEFACEFACEFACEFACEFACEFCAE |--|-|-+       |
    | pub | malvina  | FACEFACEFACEFACEFACEFACEFACEFACEFACEFCAE |  | | |       |
 +->| pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |--|-|-|-----+ |
 |  +-----+----------+------------------------------------------+  | | |     | |
 |                                                                 | | |     | |
 +-----------------------------------------------------------------|-|-|---+ | |
                                                                   | | |   | | |
 +-----------------------------------------------------------------|-|-+   | | |
 |                                                                 | |     | | |
 +->[ message from buratino ] + [ artemon ]------------------------|-|---+ | | |
                                                                   | |   | | | |
 +-----------------------------------------------------------------+ |   | | | |
 |  artemon-buratino                                                 |   | | | |
 |  +-----+----------+------------------------------------------+    |   | | | |
 +->| sec | buratino | CACACACACACACACACACACACACACACACACACACACA |----|-+ | | | |
    | pub | buratino | CACACACACACACACACACACACACACACACACACACACA |    | | | | | |
 +->| pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |----|-|-|-|-|-+
 |  +-----+----------+------------------------------------------+    | | | | |
 |                                                                   | | | | |
 +-------------------------------------------------------------------|-|-+ | |
                                                                     | |   | |
 +-------------------------------------------------------------------|-+   | |
 |                                                                   |     | |
 +--[ message-from-malvina ] + [ artemon ]---------------------------|-----+ |
                                                                     |       |
 +-------------------------------------------------------------------|-------+
 |  buratino                                                         |
 |  +-----+----------+------------------------------------------+    |
 +->| sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |----|-+
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |    | |
 +->| pub | malvina  | FACEFACEFACEFACEFACEFACEFACEFACEFACEFCAE |----+ |
 |  +-----+----------+------------------------------------------+      |
 |                                                                     |
 +--[ message from buratino ]                                          |
    [ message from malvina ] + [ artemon ]<----------------------------+


    Вполне хватило бы опции [--fingerprint], чтобы поймать и сильно ухватить за .... всякую шавку. Дополнительно присутствует возможность построения сети доверия (WoT) через третьи лица или публичные сервера (до сетей еще не добрались пока) ист.lxf-2017-224. Все эти размышления должны наводить на одну основную мысль, открытый ключ должен обладать максимальной распространенностью (публичностью).
    Как минимум этот момент надо держать на заметке.

7.3.4.0. Применив команду [--fingerprint] получаем список ключей с удобным идентификатором ключей (с пробелами).


example malvina > gpg --homedir /tmp/dir_malvina --no-permission-warning --fingerprint
/tmp/dir_malvina/pubring.kbx
-------------------------------------------
pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863 BA81 4540 018D 08AA  5191 01C2 ABCE 329C 32E4
uid           [ultimate] Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]


    Для тех "кто в танке", идентификатор позволяет по незащищенным каналам провести проверку.

7.3.5. Публикация открытого ключа.

    Публикация - предание максмальной распространенности любыми способами, в общедоступных местах или на специальных серверах. Раздавайте свой открытый ключ: "Если вы приедете на одну из крупных конференций разработчиков открытого ПО, например, OSCon, Akademy или Guadec, вы, вероятно, увидите странный пункт в программе мероприятия, называющийся ‘key signing party’ («вечеринка подписания ключей», не путайте с ‘key party’ [key party – вечеринка, в начале которой мужчины складывают ключи от машин в кучу, а в конце женщины выбирают случайный ключ, определяя тем самым своего сексуального партнера, – прим.пер.]). Это возможность для разработчиков поделиться открытыми PGP-ключами, а также единственный способ получить на 100% достоверный ключ, не перехваченный при пересылке (что известно как «атака посредника»). Пусть вы не разработчик, но распространение своего открытого ключа по доверенному каналу – прекрасный способ подтвердить свою личность, во многом подобный подписи в реальной жизни." ист.lxf-2007-91.

7.3.5.0. В наших учебных целях скопируем в общее место [/tmp] и проверим содержимое каталога.


example malvina > cp -v /tmp/dir_malvina/malvina_bin.pgp /tmp
'/tmp/dir_malvina/malvina_bin.pgp' -> '/tmp/malvina_bin.pgp'
example malvina > cp -v /tmp/dir_malvina/malvina_ascii.pgp /tmp
'/tmp/dir_malvina/malvina_ascii.pgp' -> '/tmp/malvina_ascii.pgp'

example buratino > cp -v /tmp/dir_buratino/buratino_bin.pgp /tmp
'/tmp/dir_buratino/buratino_bin.pgp' -> '/tmp/buratino_bin.pgp'
example buratino > cp -v /tmp/dir_buratino/buratino_ascii.pgp /tmp
'/tmp/dir_buratino/buratino_ascii.pgp' -> '/tmp/buratino_ascii.pgp'

example > ls -l
total 24
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    +-----+----------+------------------------------------------+

    [ file: malvina_bin.key ]   >----------------------------------+
    [ file: malvina_ascii.key ] >----------------------------------|-+
                                                                   | |
    buratino                                                       | |
    +-----+----------+------------------------------------------+  | |
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |  | |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |  | |
    +-----+----------+------------------------------------------+  | |
                                                                   | |
    [ file: buratino_bin.key ]   >---------------------------------|-|-+
    [ file: buratino_ascii.key ] >---------------------------------|-|-|-+
                                                                   | | | |
    PUBLIC AREA                                                    | | | |
    [ file: malvina_bin.key ]   <----------------------------------+ | | |
    [ file: malvina_ascii.key ] <------------------------------------+ | |
    [ file: buratino_bin.key ]   <-------------------------------------+ |
    [ file: buratino_ascii.key ] <---------------------------------------+


7.3.6. Импорт ключа.

    "...Однако поскольку любой может создать и загрузить ключи, неразумно доверять их подлинности, сначала в ней не удостоверившись..." ист.lxf-2017-224.

7.3.6.0. Применив команду [--import] с указанием файла [malvina_ascii.key] импортируем открытый ключ.


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --import /tmp/malvina_ascii.key
gpg: pub  rsa3072/01C2ABCE329C32E4 2013-04-06  Malvina Karabasovna <malvina@mail>
gpg: using pgp trust model
gpg: key 01C2ABCE329C32E4: public key "Malvina Karabasovna <malvina@mail>" imported
gpg: Total number processed: 1
gpg:               imported: 1


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |<--+
    +-----+----------+------------------------------------------+   |
                                                                    |
    [ file: buratino_bin.key ]                                      |
    [ file: buratino_ascii.key ]                                    |
                                                                    |
    PUBLIC AREA                                                     |
    [ file: malvina_bin.key ]                                       |
    [ file: malvina_ascii.key ]-------------------------------------+
    [ file: buratino_bin.key ]
    [ file: buratino_ascii.key ]


7.3.6.1. Применив команду [--list-public-keys] смотрим список имеющихся открытых ключей.


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --list-public-keys 
gpg: using pgp trust model
/tmp/dir_buratino/pubring.kbx
--------------------------------------------
pub   rsa4096 2013-04-06 [SC] [expires: 2013-05-05]
      744331AE1D8C709352A197FEDC3CCB8F4B75702C
uid           [ultimate] Buratino (free boy) <buratino@mail>
sub   rsa4096 2013-04-06 [E] [expires: 2013-05-05]

pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid           [ unknown] Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    +-----+----------+------------------------------------------+


    Обращаем внимание в строчке [uid] значение [ unknow], что значит доверие к ключу неизвестно.

7.3.6.2. Если мы доверяем ключу, то его нужно подписать. Применив команду [--edit-key] с указанием идентификатора перейдем к процессу редактирования ключа.


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --edit-key malvina@mail
gpg *
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


gpg: using pgp trust model
pub  rsa3072/01C2ABCE329C32E4
     created: 2013-04-06  expires: 2015-04-05  usage: SC  
     trust: unknown       validity: unknown
sub  rsa3072/378705AA7ACE854F
     created: 2013-04-06  expires: 2015-04-05  usage: E   
[ unknown] (1). Malvina Karabasovna <malvina@mail>


    Обратите внимание на интерактивное приглашение [pgp>]. Здесь всегда можно запросить помощь командой [help] и ознакомиться с доступными командами.


gpg> help
quit        quit this menu
save        save and quit
help        show this help
fpr         show key fingerprint
grip        show the keygrip
list        list key and user IDs
uid         select user ID N
key         select subkey N
check       check signatures
sign        sign selected user IDs [* see below for related commands]
lsign       sign selected user IDs locally
tsign       sign selected user IDs with a trust signature
nrsign      sign selected user IDs with a non-revocable signature
deluid      delete selected user IDs
delkey      delete selected subkeys
delsig      delete signatures from the selected user IDs
pref        list preferences (expert)
showpref    list preferences (verbose)
trust       change the ownertrust
revsig      revoke signatures on the selected user IDs
enable      enable key
disable     disable key
showphoto   show selected photo IDs
clean       compact unusable user IDs and remove unusable signatures from key
minimize    compact unusable user IDs and remove all signatures from key

* The 'sign' command may be prefixed with an 'l' for local signatures (lsign),
  a 't' for trust signatures (tsign), an 'nr' for non-revocable signatures
  (nrsign), or any combination thereof (ltsign, tnrsign, etc.).


    Подписываем командой [sign].


gpg> sign

pub  rsa3072/01C2ABCE329C32E4
     created: 2013-04-06  expires: 2015-04-05  usage: SC  
     trust: unknown       validity: unknown
 Primary key fingerprint: E863 BA81 4540 018D 08AA  5191 01C2 ABCE 329C 32E4

     Malvina Karabasovna <malvina@mail>

This key is due to expire on 2015-04-05.
Are you sure that you want to sign this key with your
key "Buratino (free boy) <buratino@mail>" (DC3CCB8F4B75702C)

Really sign? (y/N) y
gpg: pinentry launched ( * )
gpg: RSA/SHA512 signature from: "DC3CCB8F4B75702C Buratino (free boy) <buratino@mail>"


    Выходим командой [quit].


gpg> quit
Save changes? (y/N) y


7.3.6.3. Применив команду [--list-public-keys] смотрим список имеющихся открытых ключей и проверяем подпись.


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --list-public-keys 
gpg: using pgp trust model
gpg: checking the trustdb
gpg: 1 key processed (1 validity count cleared)
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: depth: 0  valid:   1  signed:   1  trust: 0-, 0q, 0n, 0m, 0f, 1u
gpg: depth: 1  valid:   1  signed:   0  trust: 1-, 0q, 0n, 0m, 0f, 0u
gpg: next trustdb check due at 2013-05-05
/tmp/pubring.kbx
--------------------------------------------
pub   rsa4096 2013-04-06 [SC] [expires: 2013-05-05]
      744331AE1D8C709352A197FEDC3CCB8F4B75702C
uid           [ultimate] Buratino (free boy) <buratino@mail>
sub   rsa4096 2013-04-06 [E] [expires: 2013-05-05]

pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid           [  full  ] Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]


    Значение [  full   ] указывает на полное доверие ключу. Дополнительно обратите на информационные строчки выше, началось построение доверия. Не то чтобы неподписанным ключом нельзя пользоваться, как минимум меньше предупреждений на экране.

7.3.6.4. А в это время на другой стороне применив команду [--import] происходит импортирование полученного открытого ключа из файла [buratino_bin.key].


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --import /tmp/buratino_bin.key
gpg: pub  rsa4096/DC3CCB8F4B75702C 2013-04-06  Buratino (free boy) <buratino@mail>
gpg: using pgp trust model
gpg: key DC3CCB8F4B75702C: public key "Buratino (free boy) <buratino@mail>" imported
gpg: Total number processed: 1
gpg:               imported: 1


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |<--+
    +-----+----------+------------------------------------------+   |
                                                                    |
    [ file: malvina_bin.key ]                                       |
    [ file: malvina_ascii.key ]                                     |
                                                                    |
    PUBLIC AREA                                                     |
    [ file: malvina_bin.key ]                                       |
    [ file: malvina_ascii.key ]                                     |
    [ file: buratino_bin.key ]--------------------------------------+
    [ file: buratino_ascii.key ]


7.3.6.5. Применив команду [--list-public-keys] смотрим список имеющихся открытых ключей.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --list-public-keys 
gpg: using pgp trust model
/tmp/dir_malvina/pubring.kbx
-------------------------------------------
pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid           [ultimate] Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]

pub   rsa4096 2013-04-06 [SC] [expires: 2013-05-05]
      744331AE1D8C709352A197FEDC3CCB8F4B75702C
uid           [ unknown] Buratino (free boy) <buratino@mail>
sub   rsa4096 2013-04-06 [E] [expires: 2013-05-05]


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    +-----+----------+------------------------------------------+


7.3.6.6. Применив команду [--edit-key] с указанием идентификатора осуществляем подписывание ключа.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --edit-key buratino@mail
gpg *
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


gpg: using pgp trust model
pub  rsa4096/DC3CCB8F4B75702C
     created: 2013-04-06  expires: 2013-05-05  usage: SC  
     trust: unknown       validity: unknown
sub  rsa4096/878167245DEA6988
     created: 2013-04-06  expires: 2013-05-05  usage: E   
[ unknown] (1). Buratino (free boy) <buratino@mail>

gpg> sign

pub  rsa4096/DC3CCB8F4B75702C
     created: 2013-04-06  expires: 2013-05-05  usage: SC  
     trust: unknown       validity: unknown
 Primary key fingerprint: 7443 31AE 1D8C 7093 52A1  97FE DC3C CB8F 4B75 702C

     Buratino (free boy) <buratino@mail>

This key is due to expire on 2013-05-05.
Are you sure that you want to sign this key with your
key "Malvina Karabasovna <malvina@mail>" (01C2ABCE329C32E4)

Really sign? (y/N) y
gpg: pinentry launched ( * )
gpg: RSA/SHA512 signature from: "01C2ABCE329C32E4 Malvina Karabasovna <malvina@mail>"

gpg> quit
Save changes? (y/N) y

7.3.6.7. Применив команду [--list-public-keys] проверяется подпись.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --list-public-keys 
gpg: using pgp trust model
gpg: checking the trustdb
gpg: 1 key processed (1 validity count cleared)
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: depth: 0  valid:   1  signed:   1  trust: 0-, 0q, 0n, 0m, 0f, 1u
gpg: depth: 1  valid:   1  signed:   0  trust: 1-, 0q, 0n, 0m, 0f, 0u
gpg: next trustdb check due at 2015-04-05
/tmp/dir_malvina/pubring.kbx
-------------------------------------------
pub   rsa3072 2013-04-06 [SC] [expires: 2015-04-05]
      E863BA814540018D08AA519101C2ABCE329C32E4
uid           [ultimate] Malvina Karabasovna <malvina@mail>
sub   rsa3072 2013-04-06 [E] [expires: 2015-04-05]

pub   rsa4096 2013-04-06 [SC] [expires: 2013-05-05]
      744331AE1D8C709352A197FEDC3CCB8F4B75702C
uid           [  full  ] Buratino (free boy) <buratino@mail>
sub   rsa4096 2013-04-06 [E] [expires: 2013-05-05]


    Значение [  full   ] указывает на полное доверие ключу.

7.3.7. Подпись. Создание.

    Подпись - подтверждает авторство и гарантирует неизменность содержимого.

7.3.7.0. Проверяем содержимое каталога [dir_malvina].


example malvina > ls -l /tmp/dir_malvina
total 84
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.7.1. Создадим сообщение в файле [message_to_buratino.txt].


example malvina > echo "Hello!" > /tmp/dir_malvina/message_to_buratino.txt


7.3.7.2. Проверяем содержимое каталога [dir_malvina] на наличе файла [messge_to_buratino.txt].


example malvina > ls -l /tmp/dir_malvina
total 88
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root     7 Apr  6 20:13 message_to_buratino.txt
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.7.3. Проверим содержимое файла [message_to_buratino.txt].


example malvina > cat /tmp/dir_malvina/message_to_buratino.txt 
Hello!


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    +-----+----------+------------------------------------------+

    [ file: malvina_bin.key ]
    [ file: malvina_ascii.key ]
++  [ file: message_to_buratino.txt ]


7.3.7.4. Применив команду [--detach-sign] к файлу [message_to_buratino.txt] создадим файл подпись в бинарном формате.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --detach-sign /tmp/dir_malvina/message_to_buratino.txt
gpg: using pgp trust model
gpg: writing to '/tmp/dir_malvina/message_to_buratino.txt.sig'
gpg: RSA/SHA512 signature from: "01C2ABCE329C32E4 Malvina Karabasovna <malvina@mail>"


    malvina
    +-----+----------+------------------------------------------+
 +->| sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
 |  | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |  |
 |  | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |  |
 |  +-----+----------+------------------------------------------+  |
 |                                                                 |
 |  [ file: malvina_bin.key ]                                      |
 |  [ file: malvina_ascii.key ]                                    |
 +--[ file: message_to_buratino.txt ]                              |
    [ file: message_to_buratino.txt.sig ]<-------------------------+


7.3.7.5. Проверим содержимое каталога [dir_malvina] и обнаружим файл подпись [message_to_buratino.txt.sig] в бинарном формате.


example malvina > ls -l /tmp/dir_malvina/
total 92
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root     7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root   438 Apr  6 20:13 message_to_buratino.txt.sig
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.7.6. Посмотрим на содержимое файла подписи [message_to_buratino.txt.sig].


example malvina > xxd -g 1 /tmp/dir_malvina/message_to_buratino.txt.sig 
00000000: 89 01 b3 04 00 01 0a 00 1d 16 21 04 1b b8 8b 75  ..........!....u
00000010: 09 ee 24 25 e9 d7 f9 78 3c 21 02 ff 87 68 f6 f1  ..$%...x<!...h..
00000020: 05 02 51 5f 33 67 00 0a 09 10 3c 21 02 ff 87 68  ..Q_3g....<!...h
00000030: f6 f1 5c 86 0c 00 be 5f 2f a2 0b 02 95 22 df 08  ..\...._/...."..
00000040: be bc 02 a7 1a 2e 3b 11 72 46 56 b7 bb d6 8e 91  ......;.rFV.....
00000050: 28 87 72 6f 44 16 ad 38 d7 ec a0 c4 c6 b8 e3 d1  (.roD..8........
00000060: de 7c 8d ea 7a 0b e7 bd 08 48 33 7f 54 81 55 50  .|..z....H3.T.UP
00000070: 81 03 6c 22 ad 06 6f c8 42 54 bb 2f f7 4a 1e fe  ..l"..o.BT./.J..
00000080: 96 f3 b0 87 96 9f d1 23 5e 0c 1b dd 38 61 34 b0  .......#^...8a4.
00000090: f7 4e 11 c2 56 3a 43 5d 09 36 f8 ba 92 1c 71 05  .N..V:C].6....q.
000000a0: 41 c4 94 3c cc 56 03 85 77 ad a6 e5 1a e7 04 ab  A..<.V..w.......
000000b0: 90 04 ab 56 d6 94 f9 8a 1c e2 2f 3b f3 48 fb b5  ...V....../;.H..
000000c0: 50 f0 46 9d 4c b1 c3 35 28 21 25 c2 f2 33 8d 0c  P.F.L..5(!%..3..
000000d0: a7 9c 8a 0a 08 79 ef 11 c8 ca 2a ee a7 23 55 ff  .....y....*..#U.
000000e0: 17 8d ff 6a 38 55 22 aa 38 86 29 02 7c f9 ef a6  ...j8U".8.).|...
000000f0: 2f dc c3 2d b1 10 21 d3 82 38 43 e0 01 e8 02 64  /..-..!..8C....d
00000100: 2f b5 9b 93 f5 a1 4b 3c 4c 08 4a 3a 88 fb 6a 03  /.....K<L.J:..j.
00000110: ae da a7 40 50 84 85 c8 04 b7 6f 89 c8 04 2d 74  ...@P.....o...-t
00000120: 68 46 7d f8 ba 6c 81 f5 25 db b6 39 bb 89 b9 b7  hF}..l..%..9....
00000130: c4 fd 09 e4 de 2d 21 ed 2d 43 ae 67 58 c6 b1 ad  .....-!.-C.gX...
00000140: 08 8f a2 55 0a 6c ae 43 71 a7 19 c4 e2 2d 83 05  ...U.l.Cq....-..
00000150: 73 8b 1a 32 d9 4c 16 12 b6 17 6d 3f 05 10 28 11  s..2.L....m?..(.
00000160: 76 59 dc e9 48 18 6e dc 5c 47 68 68 91 97 f5 75  vY..H.n.\Ghh...u
00000170: 32 86 76 70 6e 23 56 7f 20 00 e8 6d cc 8d ab 17  2.vpn#V. ..m....
00000180: 92 6f 26 a9 9b bd e4 82 84 f6 fb cc 52 25 d8 52  .o&.........R%.R
00000190: ad 04 7b ea 0e b2 e9 a3 d5 a3 a8 6f 11 d8 17 09  ..{........o....
000001a0: 07 37 22 92 f8 d1 e8 79 a8 d1 65 7f f1 77 51 55  .7"....y..e..wQU
000001b0: 2d 45 af 91 52 0e                                -E..R.


7.3.7.7. Применив команду [--detach-sign] с опцией [--armor] к файлу [message_to_buratino.txt] создадим файл подпись в ascii формате.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --detach-sign --armor /tmp/dir_malvina/message_to_buratino.txt
gpg: using pgp trust model
gpg: writing to '/tmp/dir_malvina/message_to_buratino.txt.asc'
gpg: RSA/SHA512 signature from: "01C2ABCE329C32E4 Malvina Karabasovna <malvina@mail>"


    malvina
    +-----+----------+------------------------------------------+
 +->| sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
 |  | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |  |
 |  | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |  |
 |  +-----+----------+------------------------------------------+  |
 |                                                                 |
 |  [ file: malvina_ascii.key ]                                    |
 |  [ file: malvina_bin.key ]                                      |
 +--[ file: message_to_buratino.txt ]                              |
    [ file: message_to_buratino.txt.sig ]                          |
    [ file: message_to_buratino.txt.asc ]<-------------------------+


7.3.7.8. Проверим содержимое каталога [dir_malvina] и обнаружим файл подпись [message_to_buratino.txt.asc] в ascii формате.


example malvina > ls -l /tmp/dir_malvina/
total 96
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root     7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root   659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root   438 Apr  6 20:13 message_to_buratino.txt.sig
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.7.9. Посмотрим на содержимое файла подписи [message_to_buratino.txt.asc].


example malvina > cat /tmp/dir_malvina/message_to_buratino.txt.asc 
-----BEGIN PGP SIGNATURE-----

iQGzBAABCgAdFiEEG7iLdQnuJCXp1/l4PCEC/4do9vEFAlFfM7oACgkQPCEC/4do
9vH+5AwApgOkyitaSjvu4d214GPI0/ElajDt87tzn87Xhhs+p0ERBk41iNMX7zve
yDvNj60qXBB7ZkvaXa5gNvBkgVjp55P6IDhw2tnWo2mt14gj2J+phg4FOT9e+irf
7aKDQFiMGLfhaDB//j3g6HNo/hA4S8wbMbhYT4hUDrJ07SNRZG8N0cadsng0+T7l
PnZkHIp9jTmZZbBvSzA4GXIeOYJ/Vurh2x6szszIvqjgTxxT7hE6i1QfjJjiXQ8F
5QtZfIARyES51ekh4AO4ZsF8jlKSzm4ZB75leCJz9npKeDweR8byMAvrwlyG//lU
uXKn14r9TJmdiiV+lvRzTZVLi9xy08To3Lt3w+N7DuAY6FHgfdFWgPyeZKSbe9XI
Q0hQ74cwgX5+Ps+924cVVQmOVEW1RbrWX2i4u6HJ5lPEBSlvZ8kSWG0jkIKAxx4X
6sAZK4G2X2N1rbaZRDSdkyeH5U6GotdtLwHixt3/nLVz6IExosnJIAnXbSwotARn
tAT4/mtK
=8MCb
-----END PGP SIGNATURE-----


7.3.7.10. Публикация файлов. В наших учебных целях скопируем в общее место [/tmp] и проверим содержимое каталога.


example > ls -l /tmp
total 24
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp

example malvina > cp -v /tmp/dir_malvina/message_to_buratino.txt /tmp
'/tmp/dir_malvina/message_to_buratino.txt' -> '/tmp/message_to_buratino.txt'
example malvina > cp -v /tmp/dir_malvina/message_to_buratino.txt.sig /tmp
'/tmp/dir_malvina/message_to_buratino.txt.sig' -> '/tmp/message_to_buratino.txt.sig'
example malvina > cp -v /tmp/dir_malvina/message_to_buratino.txt.asc /tmp
'/tmp/dir_malvina/message_to_buratino.txt.asc' -> '/tmp/message_to_buratino.txt.asc'

example > ls -l /tmp
total 36
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root    7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root  659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root  438 Apr  6 20:13 message_to_buratino.txt.sig


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    +-----+----------+------------------------------------------+

    [ file: malvina_bin.key ]
    [ file: malvina_ascii.key ]
    [ file: message_to_buratino.txt ]     >------------------------+
    [ file: message_to_buratino.txt.sig ] >------------------------|-+
    [ file: message_to_buratino.txt.asc ] >------------------------|-|-+
                                                                   | | |
    PUBLIC AREA                                                    | | |
    [ file: malvina_bin.key ]                                      | | |
    [ file: malvina_ascii.key ]                                    | | |
    [ file: buratino_bin.key ]                                     | | |
    [ file: buratino_ascii.key ]                                   | | |
    [ file: message_to_buratino.txt ]     <------------------------+ | |
    [ file: message_to_buratino.txt.sig ] <--------------------------+ |
    [ file: message_to_buratino.txt.asc ] <----------------------------+


7.3.8. Подпись. Проверка.


7.3.8.0. Применив команду [--verify] к файлу подписи [message_to_buratino.txt.sig] проверим содержимое незашифрованного файла [message_to_buratino.txt].


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --verify /tmp/message_to_buratino.txt.sig 
gpg: assuming signed data in '/tmp/message_to_buratino.txt'
gpg: Signature made Sat 06 Apr 2013 06:04:13 PM MMM
gpg:                using RSA key E863BA814540018D08AA519101C2ABCE329C32E4
gpg: using pgp trust model
gpg: Good signature from "Malvina Karabasovna <malvina@mail>" [full]
gpg: binary signature, digest algorithm SHA512, key algorithm rsa3072


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
 +->| pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |-->[ Good signature from "Malvina Karabasovna <malvina@mail>" [full] ]
 |  +-----+----------+------------------------------------------+
 |
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 |
 |  PUBLIC AREA
 |  [ file: malvina_bin.key ]
 |  [ file: malvina_ascii.key ]
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 +--[ file: message_to_buratino.txt ]
 +--[ file: message_to_buratino.txt.sig ]
    [ file: message_to_buratino.txt.asc ]


    Сообщение "Good signature from ..." информирует, что содержимое файла соответствует подписи от "from "Malvina Karabasovna <malvina@mail>"" обладающая "[full]" полным доверием.

7.3.8.1. Применив команду [--verify] к файлу подписи [message_to_buratino.txt.asc] проверим содержимое незашифрованного файла [message_to_buratino.txt].


example malvina > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --verify /tmp/message_to_buratino.txt.asc 
gpg: assuming signed data in '/tmp/dir_malvina/message_to_buratino.txt'
gpg: Signature made Sat 06 Apr 2013 06:04:13 PM MMM
gpg:                using RSA key E863BA814540018D08AA519101C2ABCE329C32E4
gpg: using pgp trust model
gpg: Good signature from "Malvina Karabasovna <malvina@mail>" [full]
gpg: binary signature, digest algorithm SHA512, key algorithm rsa3072


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
 +->| pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |-->[ Good signature from "Malvina Karabasovna <malvina@mail>" [full] ]
 |  +-----+----------+------------------------------------------+
 |
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 |
 |  PUBLIC AREA
 |  [ file: malvina_bin.key ]
 |  [ file: malvina_ascii.key ]
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 +--[ file: message_to_buratino.txt ]
 |  [ file: message_to_buratino.txt.sig ]
 +--[ file: message_to_buratino.txt.asc ]


    Сообщение "Good signature from ..." информирует, что содержимое файла соответствует подписи. Между бинарным и ascii форматом разницы результата не видно.

7.3.8.2. Подмешивание кода. Чтобы до конца разобраться с проверкой подписи подправим файл [message_to_burratino.txt] расположенный в общем месте. Проверяем содержимое каталога [/tmp].


example artemon > ls -l /tmp
total 36
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root    7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root  659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root  438 Apr  6 20:13 message_to_buratino.txt.sig


    Изучаем содержимое файла [message_to_buratino.txt].


example artemon > xxd /tmp/message_to_buratino.txt
00000000: 4865 6c6c 6f21 0a                        Hello!.


    С адреса "00000002:" подмешиваем код "2121".


example artemon > echo "00000002: 2121" | xxd -r - /tmp/message_to_buratino.txt


    Проверяем результат.


example artemon > xxd /tmp/message_to_buratino.txt
00000000: 4865 2121 6f21 0a                        He!!o!.


    Проверяем содержимое каталога [/tmp].


example artemon > ls -l /tmp
total 36
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root    7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root  659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root  438 Apr  6 20:13 message_to_buratino.txt.sig


    Изменилось только содержимое файла [message_to_buratino.txt] с "Hello!" на "He!!o!".

7.3.8.3. Применив команду [--verify] к файлу подписи [message_to_buratino.txt.sig] проверим содержимое незашифрованного файла [message_to_buratino.txt].


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --verify /tmp/message_to_buratino.txt.sig
gpg: assuming signed data in '/tmp/message_to_buratino.txt'
gpg: Signature made Sat 06 Apr 2013 06:04:13 PM MMM
gpg:                using RSA key E863BA814540018D08AA519101C2ABCE329C32E4
gpg: using pgp trust model
gpg: BAD signature from "Malvina Karabasovna <malvina@mail>" [full]
gpg: binary signature, digest algorithm SHA512, key algorithm rsa3072


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
 +->| pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |-->[ BAD signature from "Malvina Karabasovna <malvina@mail>" [full] ]
 |  +-----+----------+------------------------------------------+
 |
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 |
 |  PUBLIC AREA
 |  [ file: malvina_bin.key ]
 |  [ file: malvina_ascii.key ]
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 +--[ file: message_to_buratino.txt ]
 +--[ file: message_to_buratino.txt.sig ]
    [ file: message_to_buratino.txt.asc ]


    Сообщение "BAD signature from ..." информирует, что содержимое файла НЕ соответствует подписи.

7.3.8.4. Проверка подписи. Применив команду [--verify] к файлу подписи [message_to_buratino.txt.asc] проверим содержимое незашифрованного файла [message_to_buratino.txt].


example > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --verify /tmp/message_to_buratino.txt.asc
gpg: assuming signed data in '/tmp/message_to_buratino.txt'
gpg: Signature made Sat 06 Apr 2013 06:04:13 PM MMM
gpg:                using RSA key E863BA814540018D08AA519101C2ABCE329C32E4
gpg: using pgp trust model
gpg: BAD signature from "Malvina Karabasovna <malvina@mail>" [full]
gpg: binary signature, digest algorithm SHA512, key algorithm rsa3072


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
 +->| pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |-->[ BAD signature from "Malvina Karabasovna <malvina@mail>" [full] ]
 |  +-----+----------+------------------------------------------+
 |
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 |
 |  PUBLIC AREA
 |  [ file: malvina_bin.key ]
 |  [ file: malvina_ascii.key ]
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 +--[ file: message_to_buratino.txt ]
 |  [ file: message_to_buratino.txt.sig ]
 +--[ file: message_to_buratino.txt.asc ]


    Сообщение "BAD signature from ..." информирует, что содержимое файла НЕ соответствует подписи. Еще раз убедились бинарный и ascii формат работает одинаково.

7.3.9. Шифрование.

    Шифрование - процесс скрытия.

7.3.9.0. Проверяем содержимое каталога [dir_buratino].


example buratino > ls -l /tmp/dir_buratino
total 88
-rw-r--r-- 1 root root  3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root  2267 Apr  6 20:13 buratino_bin.pgp
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  5011 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw------- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.9.1 Создадим сообщение в файле [message_to_malvina.txt].


example buratino > echo "Hi! We have a problem." > /tmp/dir_buratino/message_to_malvina.txt


7.3.9.2. Проверим содержимое файла [message_to_malvina.txt].


example buratino > cat /tmp/dir_buratino/message_to_malvina.txt 
Hi! We have a problem.


7.3.9.3. Проверяем содержимое каталога [dir_buratino] на наличие файла [message_to_malvina.txt].


example buratino> ls -l /tmp/dir_buratino/
total 92
-rw-r--r-- 1 root root  3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root  2267 Apr  6 20:13 buratino_bin.pgp
-rw-r--r-- 1 root root    23 Apr  6 20:13 message_to_malvina.txt
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  5011 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw------- 1 root root  1360 Apr  6 20:13 trustdb.gpg


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    +-----+----------+------------------------------------------+

    [ file: buratino_bin.key ]
    [ file: buratino_ascii.key ]
++  [ file: message_to_malvina.txt ]


7.3.9.4. Применив команду [--encrypt] к файлу [message_to_malvina.txt] создадим зашифрованный файл в бинарном формате. Добавив опцию [--recipient] указываем получателя (на самом деле используемый открытый ключ).


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --recipient malvina@mail --encrypt /tmp/dir_buratino/message_to_malvina.txt 
gpg: using pgp trust model
gpg: using subkey 378705AA7ACE854F instead of primary key 01C2ABCE329C32E4
gpg: automatically retrieved 'malvina@mail' via Local
gpg: This key probably belongs to the named user
gpg: reading from '/tmp/dir_buratino/message_to_malvina.txt'
gpg: writing to '/tmp/dir_buratino/message_to_malvina.txt.gpg'
gpg: RSA/AES256 encrypted for: "378705AA7ACE854F Malvina Karabasovna <malvina@mail>"


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
+-->| pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
|   +-----+----------+------------------------------------------+  |
|                                                                  |
|   [ file: buratino_bin.key ]                                     |
|   [ file: buratino_ascii.key ]                                   |
+---[ file: message_to_malvina.txt ]                               |
    [ file: message_to_malvina.txt.gpg ]<--------------------------+


7.3.9.5. Проверяем содержимое каталога [dir_buratino] и обнаруживаем зашифрованный файл [message_to_malvina.txt.gpg] в бинарном формате.


example buratino > ls -l /tmp/dir_buratino/
total 96
-rw-r--r-- 1 root root  3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root  2267 Apr  6 20:13 buratino_bin.pgp
-rw-r--r-- 1 root root    23 Apr  6 20:13 message_to_malvina.txt
-rw-r--r-- 1 root root   505 Apr  6 20:13 message_to_malvina.txt.gpg
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  5011 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw------- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.9.6. Посмотрим на содержимое зашифрованного файла [message_to_malvina.txt.gpg].


example buratino > xxd -g 1 /tmp/dir_buratino/message_to_malvina.txt.gpg 
00000000: 85 01 8c 03 1a d8 a8 03 8d a1 bd 44 01 0c 00 ad  ...........D....
00000010: ff 17 cf 48 b4 28 0b 34 16 9e 02 67 99 e8 1a 8f  ...H.(.4...g....
00000020: 52 5c 7d f1 56 40 37 b8 31 d0 a6 77 23 3c 17 e4  R\}.V@7.1..w#<..
00000030: f3 24 7a 68 0a 0c 6d 33 e8 94 80 fc 80 22 81 51  .$zh..m3.....".Q
00000040: 66 32 98 27 e0 c6 02 e7 6a cd 43 d0 32 03 89 bf  f2.'....j.C.2...
00000050: e7 2e 41 10 29 2c d3 8a 5d 2f 4c ba 10 8b 4e 07  ..A.),..]/L...N.
00000060: 47 9a e6 dd 45 47 51 0a d7 3e 14 43 09 f1 4b 33  G...EGQ..>.C..K3
00000070: 2a f3 5d 5a 26 f1 b1 38 d4 c5 4f af 2d 84 5d d6  *.]Z&..8..O.-.].
00000080: 44 60 be de 7d 11 97 f6 6a 50 eb 93 58 74 0a f3  D`..}...jP..Xt..
00000090: 3f 7b 7e d4 09 de 9b e9 43 44 84 c8 ae 31 e4 a4  ?{~.....CD...1..
000000a0: cb 8a 7f 86 d1 d8 37 a2 b5 c4 5d b1 3d ff 74 92  ......7...].=.t.
000000b0: a8 e0 66 93 42 71 9c 22 7d 56 17 48 92 4f 36 ff  ..f.Bq."}V.H.O6.
000000c0: 60 55 a1 ec 42 be 4c 20 a9 d3 96 08 a8 25 fa 73  `U..B.L .....%.s
000000d0: 8f 51 e3 1a 2c 80 99 88 ac 4b c8 ac 64 1a 18 69  .Q..,....K..d..i
000000e0: 32 3b 9e 46 c3 6e b3 f5 1c af 54 2c ae c7 83 79  2;.F.n....T,...y
000000f0: b3 9f 02 69 8b d1 58 5a b1 78 8c fe c7 14 56 bd  ...i..XZ.x....V.
00000100: 4a 71 4c 6f 9f 5e 4b 80 83 20 5a 84 ac fb 3e 1d  JqLo.^K.. Z...>.
00000110: b3 ad ac 5b 3d 32 94 62 64 39 8d 85 ed 5c 1b d9  ...[=2.bd9...\..
00000120: b1 17 da fb 85 da 86 26 1a 3e 9d ad a3 bc 8b de  .......&.>......
00000130: b4 c6 e4 ca 9c 75 01 fd 16 f6 bd 67 15 34 f1 22  .....u.....g.4."
00000140: e7 31 66 c4 64 83 bc 77 8a 1f 0d 74 d5 f6 0c 31  .1f.d..w...t...1
00000150: 3d 0a d1 4d d2 04 3c f7 cb 7f 7b a5 41 4e b7 db  =..M..<...{.AN..
00000160: a2 a5 65 83 29 e7 eb 9b fa a1 cd 43 d0 4f 2d ea  ..e.)......C.O-.
00000170: 1c c5 e0 07 b8 2d 2d 01 c2 bd db d2 97 e7 82 3a  .....--........:
00000180: 46 2e 33 ee ae 30 3a 91 ba dd 77 10 59 11 76 d2  F.3..0:...w.Y.v.
00000190: c0 4f 01 e6 2e 90 2a 41 5c 04 f5 ba 60 f5 ed 7f  .O....*A\...`...
000001a0: 94 fe b4 f5 fd 90 61 66 c4 23 d4 f8 7f f5 4c c5  ......af.#....L.
000001b0: 5e 42 5d af de 09 bc b2 de ef 50 0e c4 f1 72 00  ^B].......P...r.
000001c0: b1 4a 9d ae ba c6 cf ad 1b 19 af e4 1a 37 67 7e  .J...........7g~
000001d0: e2 3a ea 44 bf 40 02 5e 69 28 1c 05 b2 c6 33 89  .:.D.@.^i(....3.
000001e0: 8a e0 57 ca 4d f6 dd d1 dc ee ee c4 19 5e 25 99  ..W.M........^%.
000001f0: a9 b5 c4 00 e5 55 bc 63 77 07 08 11 49 58 b0 63  .....U.cw...IX.c
00000200: e9 3d 88 ad 1b 2e 0f cc 3d fc ce 78 47 33 ce 35  .=......=..xG3.5
00000210: 9a cd d7 3f 30 ab 6b 82 41 c3 c4 a5 89 c6 06 30  ...?0.k.A......0
00000220: 27 48 97 92 b2 15 e1 ce d7 91 ed 00 43 e2 a5 e7  'H..........C...
00000230: 2a b3 70 4f 75 87 a7 b8 e2 3b 5e 8c 98 40 b9 8f  *.pOu....;^..@..
00000240: 96 53 6c c0 b1 70 d5 c8 6e bb eb 5e a3 f2 3b c3  .Sl..p..n..^..;.
00000250: b8 6a 94 99 32 c7 01 c4 a7 1b 85 c4 27 6f 21 a3  .j..2.......'o!.
00000260: 8b 59 fd 2d f7 ff 3e 7e 69 7d 0d bb d7 8d 01 0a  .Y.-..>~i}......
00000270: b0 4d 86 2d 3d 92 4d f5 50 7c 36 6e f1 4a 2b 6b  .M.-=.M.P|6n.J+k
00000280: 31 e0 e0 3a d7 1b f7 52 3c a3 15 4c 6a 91 cb 80  1..:...R<..Lj...
00000290: 5e af 01 52 ed db 28 a2 de 6a 6a ec a3 32 75 28  ^..R..(..jj..2u(
000002a0: 9c                                               .


7.3.9.7. Применив команду [--encrypt] с опцией [--armor] к файлу [message_to_malvina.txt] создадим зашифрованный файл в ascii формате. Добавив опцию [--recipient] указываем получателя.


example buratino > gpg -v --homedir /tmp/dir_buratino --no-permission-warning --recipient malvina@mail --armor --encrypt /tmp/dir_buratino/message_to_malvina.txt 
gpg: using pgp trust model
gpg: using subkey 378705AA7ACE854F instead of primary key 01C2ABCE329C32E4
gpg: automatically retrieved 'malvina@mail' via Local
gpg: This key probably belongs to the named user
gpg: reading from '/tmp/dir_buratino/message_to_malvina.txt'
gpg: writing to '/tmp/dir_buratino/message_to_malvina.txt.asc'
gpg: RSA/AES256 encrypted for: "378705AA7ACE854F Malvina Karabasovna <malvina@mail>"


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
+-->| pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
|   +-----+----------+------------------------------------------+  |
|                                                                  |
|   [ file: buratino_bin.key ]                                     |
|   [ file: buratino_ascii.key ]                                   |
+---[ file: message_to_malvina.txt ]                               |
    [ file: message_to_malvina.txt.gpg ]                           |
    [ file: message_to_malvina.txt.asc ]<--------------------------+


7.3.9.8. Проверяем содержимое каталога [dir_buratino] и обнаруживаем зашифрованный файл [message_to_malvina.txt.asc] в ascii формате.


example buratino > ls -l /tmp/dir_buratino/
total 100
-rw-r--r-- 1 root root  3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root  2267 Apr  6 20:13 buratino_bin.pgp
-rw-r--r-- 1 root root    23 Apr  6 20:13 message_to_malvina.txt
-rw-r--r-- 1 root root   748 Apr  6 20:13 message_to_malvina.txt.asc
-rw-r--r-- 1 root root   505 Apr  6 20:13 message_to_malvina.txt.gpg
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  5011 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw------- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.9.9. Посмотрим на содержимое зашифрованного файла [message_to_malvina.txt.asc].


example buratino > cat /tmp/dir_buratino/message_to_malvina.txt.asc 
-----BEGIN PGP MESSAGE-----

hQGMAxrYqAONob1EAQwAot+LSQygCrZWiwyUeAHbJdM5mnGKpai+FecQNW+QW7P7
n9q99WuhDzDZZigoRWyojoyu9XrAx2cIX1G/tHxL3htNEC2D/5ZD1GxzLidL3hIG
orFHc6JtHcf+MUd/vyctnWMN9mjvud1ENWhQ5Mg4SFpQwNsNWvLLYp6zj+jZtTOe
jtNaCU/uhF40uPg+8gRtByZlxWSTScdK8mLXKMJ6Ta17a6L3VFQVeWbrpEAAz7Z6
nRbY86olmLBpGSl4ZS8TkVoVUkHAEMBjt0XwWDacrtwMcNyMkdHVCW+/0/mMeWKF
I7TjmAFHam3EUT1aKG/R9a8OtyvrcZ9sSV8cQ2b6Nnl8Oso0xAX2gcjx98I4i3kg
/Uy2kR8pbQTtpA9y1Gia5whu/d4A2bBX+z8eyT4x8uFLHG5iYymxQbHtnK04N66c
TaoTHyKz0mJsZ7+ZJwvrRbgIS6iCYSV5W7kFonLkHgfZwiBTjYRTnFFFQOdOUeyx
rdGh9I1f0/6uZ4RLGpnP0sBNAc6b64aJhBIxqwptAnoh9oV6VER+DbrvnHmKfQ7x
ewE4JuWZ/BkXQStKWb5j/IyDOdyEeF9LnutmUwuZ0PFqLdyYHxibGsJYPvPKvPc7
va45/l3hvXp+qPxFkAuPCRCFj+mPdNViYZD9+ujWiyZPerxiPmUlM9JJSMFsAl+O
KMLlSC6FWbNNLAH1IrhDgiyrEWoDpoIFGWAtVty6SoL1rzSBdAYBWI3QVyr/I0ax
c3c+V0etsuXZ5emDKroSKHiYUPR+RQBJBr9KFBGlBtlhdUqTWoRrTmXUjWg8JSOD
zjl3Zm0RONtuESfxyLf+QB8c/6FXJtPnjkDZ5BL9OhJMnsH/VMwsSjzgN0zPMUw=
=wGQg
-----END PGP MESSAGE-----


7.3.9.10. Публикация файлов (такие файлы лучше передавать иначе ;) ). В наших учебных целях скопируем в общее место [/tmp] и проверим содержимое каталога.


example > ls -l /tmp
total 36
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root    7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root  659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root  438 Apr  6 20:13 message_to_buratino.txt.sig

example buratino > cp -v /tmp/dir_buratino/message_to_malvina.txt.gpg /tmp
'/tmp/dir_buratino/message_to_malvina.txt.gpg' -> '/tmp/message_to_malvina.txt.gpg'
example buratino > cp -v /tmp/dir_buratino/message_to_malvina.txt.asc /tmp
'/tmp/dir_buratino/message_to_malvina.txt.asc' -> '/tmp/message_to_malvina.txt.asc'

example > ls -l /tmp
total 44
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root    7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root  659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root  438 Apr  6 20:13 message_to_buratino.txt.sig
-rw-r--r-- 1 root root  748 Apr  6 20:13 message_to_malvina.txt.asc
-rw-r--r-- 1 root root  505 Apr  6 20:13 message_to_malvina.txt.gpg


    buratino
    +-----+----------+------------------------------------------+
    | sec | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    +-----+----------+------------------------------------------+

    [ file: buratino_bin.key ]
    [ file: buratino_ascii.key ]
    [ file: message_to_malvina.txt ]
    [ file: message_to_malvina.txt.gpg ] >-------------------------+
    [ file: message_to_malvina.txt.asc ] >-------------------------|-+
                                                                   | |
    PUBLIC AREA                                                    | |
    [ file: malvina_bin.key ]                                      | |
    [ file: malvina_ascii.key ]                                    | |
    [ file: buratino_bin.key ]                                     | |
    [ file: buratino_ascii.key ]                                   | |
    [ file: message_to_buratino.txt ]                              | |
    [ file: message_to_buratino.txt.sig ]                          | |
    [ file: message_to_buratino.txt.asc ]                          | |
    [ file: message_to_malvina.txt.gpg ] <-------------------------+ |
    [ file: message_to_malvina.txt.asc ] <---------------------------+


7.3.10. Дешифрование.

    Дешифрование - неповерите, но процесс противоположный шифрованию.

7.3.10.0. Применив команду [--decrypt] к зашифрованному файлу в любом формате осуществим дешифрование содержимого. Если мы точно уверены в текстовом содержимом зашифрованного файла и опустив опцию [--output] дешифрованное содержимое будет выведено только на экран, что порой бывает очень кстати.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --decrypt /tmp/message_to_malvina.txt.gpg 
gpg: public key is 378705AA7ACE854F
gpg: no running gpg-agent - starting '/usr/bin/gpg-agent'
gpg: connection to agent established
gpg: using subkey 378705AA7ACE854F instead of primary key 01C2ABCE329C32E4
gpg: pinentry launched ( * )
gpg: using subkey 378705AA7ACE854F instead of primary key 01C2ABCE329C32E4
gpg: encrypted with 3072-bit RSA key, ID 378705AA7ACE854F, created 2013-04-06
      "Malvina Karabasovna <malvina@mail>"
gpg: AES256 encrypted data
gpg: original file name='message_to_malvina.txt'
Hi! We have a problem.


    malvina
    +-----+----------+------------------------------------------+
 +->| sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |-->[ DISPLAY ONLY ]
 |  | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
 |  | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
 |  +-----+----------+------------------------------------------+
 |
 |  [ file: malvina_bin.key ]
 |  [ file: malvina_ascii.key ]
 |  [ file: message_to_buratino.txt ]
 |  [ file: message_to_buratino.txt.sig ]
 |  [ file: message_to_buratino.txt.asc ]
 |
 |  PUBLIC AREA
 |  [ file: malvina_bin.key ]
 |  [ file: malvina_ascii.key ]
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 |  [ file: message_to_buratino.txt ]
 |  [ file: message_to_buratino.txt.sig ]
 |  [ file: message_to_buratino.txt.asc ]
 +--[ file: message_to_malvina.txt.gpg ]
    [ file: message_to_malvina.txt.asc ]


    Сразу обратите внимание из информационных сообщений непонятен автор шифрования, отсутствует подпись.

7.3.10.1. Применив команду [--decrypt] к зашифрованному файлу в любом формате осуществим дешифрование содержимого. Добавив опцию [--output] с указанием названия файла сохраним дешифрованное содержимое в указанный файл.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --output /tmp/dir_malvina/message_to_malvina.txt --decrypt /tmp/message_to_malvina.txt.asc
gpg: public key is 378705AA7ACE854F
gpg: using subkey 378705AA7ACE854F instead of primary key 01C2ABCE329C32E4
gpg: using subkey 378705AA7ACE854F instead of primary key 01C2ABCE329C32E4
gpg: encrypted with 3072-bit RSA key, ID 378705AA7ACE854F, created 2013-04-06
      "Malvina Karabasovna <malvina@mail>"
gpg: AES256 encrypted data
gpg: original file name='message_to_malvina.txt'


    malvina
    +-----+----------+------------------------------------------+
 +->| sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
 |  | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |  |
 |  | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |  |
 |  +-----+----------+------------------------------------------+  |
 |                                                                 |
 |  [ file: malvina_bin.key ]                                      |
 |  [ file: malvina_ascii.key ]                                    |
 |  [ file: message_to_buratino.txt ]                              |
 |  [ file: message_to_buratino.txt.sig ]                          |
 |  [ file: message_to_buratino.txt.asc ]                          |
 |  [ file: message_to_malvina.txt ]<------------------------------+
 |
 |  PUBLIC AREA
 |  [ file: malvina_bin.key ]
 |  [ file: malvina_ascii.key ]
 |  [ file: buratino_bin.key ]
 |  [ file: buratino_ascii.key ]
 |  [ file: message_to_buratino.txt ]
 |  [ file: message_to_buratino.txt.sig ]
 |  [ file: message_to_buratino.txt.asc ]
 |  [ file: message_to_malvina.txt.gpg ]
 +--[ file: message_to_malvina.txt.asc ]


    Убеждаемся, что любой формат зашифрованного файла одинаково работает.

7.3.10.2. Проверяем содержимое каталога [dir_malvina] и обнаруживаем дешифрованный файл [message_to_malvina.txt].


example malvina > ls -l /tmp/dir_malvina/
total 108
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root     7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root   659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root   438 Apr  6 20:13 message_to_buratino.txt.sig
-rw-r--r-- 1 root root    23 Apr  6 20:13 message_to_malvina.txt
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.10.3. Посмотрим на содержимое файла [message_to_malvina.txt].


example > cat /tmp/dir_malvina/message_to_malvina.txt 
Hi! We have a problem.


7.3.11. Шифрование с подписью.

    Содержимое не только шифруется, но и дополнительно подписывается.

7.3.11.0. Проверяем содержимое каталога [dir_malvina].


example malvina > ls -l /tmp/dir_malvina
total 108
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root     4 Apr  6 20:13 message_from_buratino.tst
-rw-r--r-- 1 root root     7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root   659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root   438 Apr  6 20:13 message_to_buratino.txt.sig
-rw-r--r-- 1 root root    23 Apr  6 20:13 message_to_malvina.txt
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.11.1. Создадим сообщение в файле [message_to_buratino_2.txt].


example malvina > echo "Hey, you write to me: We have a problem?" > /tmp/dir_malvina/message_to_buratino_2.txt


7.3.11.2. Проверим содержимое файла [message_to_buratino_2.txt].


example > cat ./dir_malvina/message_to_buratino_2.txt 
Hey, you write to me: We have a problem?


7.3.11.3. Проверим содержимое каталога [dir_malvina] на наличие файла [message_to_buratino_2.txt].


example malvina > ls -l /tmp/dir_malvina
total 112
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root     4 Apr  6 20:13 message_from_buratino.tst
-rw-r--r-- 1 root root    41 Apr  6 20:13 message_to_buratino_2.txt
-rw-r--r-- 1 root root     7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root   659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root   438 Apr  6 20:13 message_to_buratino.txt.sig
-rw-r--r-- 1 root root    23 Apr  6 20:13 message_to_malvina.txt
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    +-----+----------+------------------------------------------+

    [ file: malvina_bin.key ]
    [ file: malvina_ascii.key ]
    [ file: message_to_buratino.txt ]
    [ file: message_to_buratino.txt.sig ]
    [ file: message_to_buratino.txt.asc ]
    [ file: message_to_malvina.txt ]
++  [ file: message_to_buratino_2.txt ]


7.3.11.4. Применив команду [--encrypt] с опцией [--sign] к файлу [message_to_buratino_2.txt] создадим зашифрованный файл в бинарном формате с авторской подписью. Добавив опцию [--recipient] указываем получателя.


example malvina > gpg -v --homedir /tmp/dir_malvina --no-permission-warning --recipient buratino@mail --encrypt --sign /tmp/dir_malvina/message_to_buratino_2.txt 
gpg: using pgp trust model
gpg: using subkey 878167245DEA6988 instead of primary key DC3CCB8F4B75702C
gpg: automatically retrieved 'buratino@mail' via Local
gpg: This key probably belongs to the named user
gpg: writing to '/tmp/dir_malvina/message_to_buratino_2.txt.gpg'
gpg: RSA/AES256 encrypted for: "878167245DEA6988 Buratino (free boy) <buratino@mail>"
gpg: pinentry launched ( * )
gpg: RSA/SHA512 signature from: "01C2ABCE329C32E4 Malvina Karabasovna <malvina@mail>"


    malvina
    +-----+----------+------------------------------------------+
 +->| sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |--+
 |  | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |  |
 +->| pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |--+
 |  +-----+----------+------------------------------------------+  |
 |                                                                 |
 |  [ file: malvina_bin.key ]                                      |
 |  [ file: malvina_ascii.key ]                                    |
 |  [ file: message_to_buratino.txt ]                              |
 |  [ file: message_to_buratino.txt.sig ]                          |
 |  [ file: message_to_buratino.txt.asc ]                          |
 |  [ file: message_to_malvina.txt ]                               |
 +--[ file: message_to_buratino_2.txt ]                            |
    [ file: message_to_buratino_2.txt.gpg ]<-----------------------+


7.3.11.5. Проверяем содержимое каталога [dir_malvina] и обнаруживаем созданный зашифрованный с подписью файл [message_to_buratino_2.txt.gpg].


example malvina > ls -l /tmp/dir_malvina
total 116
-rw-r--r-- 1 root root  2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root  1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root     4 Apr  6 20:13 message_from_buratino.tst
-rw-r--r-- 1 root root    41 Apr  6 20:13 message_to_buratino_2.txt
-rw-r--r-- 1 root root  1111 Apr  6 20:13 message_to_buratino_2.txt.gpg
-rw-r--r-- 1 root root     7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root   659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root   438 Apr  6 20:13 message_to_buratino.txt.sig
-rw-r--r-- 1 root root    23 Apr  6 20:13 message_to_malvina.txt
drwx------ 2 root root  4096 Apr  6 20:13 openpgp-revocs.d
drwx------ 2 root root  4096 Apr  6 20:13 private-keys-v1.d
-rw-r--r-- 1 root root  4883 Apr  6 20:13 pubring.kbx
-rw-r--r-- 1 root root  4433 Apr  6 20:13 pubring.kbx~
-rw------- 1 root root   600 Apr  6 20:13 random_seed
-rw-r--r-- 1 root root 49152 Apr  6 20:13 tofu.db
-rw-r--r-- 1 root root  1360 Apr  6 20:13 trustdb.gpg


7.3.11.6. Посмотрим на содержимое файла [message_to_buratino_2.txt.gpg].


example malvina > xxd -g 1 /tmp/dir_malvina/message_to_buratino_2.txt.gpg 
00000000: 85 01 8c 03 1a d8 a8 03 8d a1 bd 44 01 0b ff 45  ...........D...E
00000010: 3d 4d 57 6e 76 f9 03 14 3d bc 94 3f 63 54 9b 48  =MWnv...=..?cT.H
00000020: f2 74 13 57 35 df ff e8 f9 3f b9 ed 8c b8 56 97  .t.W5....?....V.
00000030: 5f f5 7f e9 06 de ec 78 c3 f8 f8 41 a3 46 e3 36  _......x...A.F.6
00000040: 95 4c 40 e9 8c 0a 6f 64 c1 81 90 78 d3 69 26 2c  .L@...od...x.i&,
00000050: 4e 02 9e f0 0f ac 6d b5 fa f3 b4 72 3e 46 93 ba  N.....m....r>F..
00000060: cd 2b b1 e8 a9 8b 7d f1 d2 e5 a8 07 f2 3a 61 6c  .+....}......:al
00000070: 8a 57 72 ec da 21 77 a0 56 37 61 52 61 23 17 52  .Wr..!w.V7aRa#.R
00000080: 65 fb 69 af 93 d7 94 57 66 fb 06 a5 97 f3 e2 04  e.i....Wf.......
00000090: 91 e4 25 f1 65 c5 66 92 1f ef dc 77 26 a4 ed 4d  ..%.e.f....w&..M
000000a0: 42 20 28 e1 bd 6d 50 1c 8a 2a 1c 2d 03 48 28 9f  B (..mP..*.-.H(.
000000b0: 9c 50 9e 14 5c 2c e9 30 f3 88 a2 2c 7b 9f 26 59  .P..\,.0...,{.&Y
000000c0: 83 7d f7 c0 a3 5f cd 0e 77 c6 d1 24 36 c9 f7 2b  .}..._..w..$6..+
000000d0: 7b bf 61 65 41 f6 ae 6d 2e c2 28 9f 51 d6 7d d6  {.aeA..m..(.Q.}.
000000e0: ef 94 21 39 0e 49 5e dc cd 33 75 46 16 2a 26 84  ..!9.I^..3uF.*&.
000000f0: 91 3a 19 26 30 22 01 2f a8 f6 c1 4f e3 23 23 c6  .:.&0"./...O.##.
00000100: 4a c3 ae 94 04 39 2e 51 b6 02 b9 d5 84 7d ed a4  J....9.Q.....}..
00000110: e3 57 57 3e 60 14 73 9e 07 00 4c 4e 1d 8d f9 9d  .WW>`.s...LN....
00000120: 8a 39 b0 2c 0c ee 2b 4a 3d f4 de 2e 34 5e 05 fc  .9.,..+J=...4^..
00000130: 7d d8 ac 5f 79 e5 8c b6 ce 8f 34 f1 f3 41 58 61  }.._y.....4..AXa
00000140: 10 97 6b 1a cb 86 ca ad 2b 21 22 77 f0 19 eb 75  ..k.....+!"w...u
00000150: fc 75 49 d9 39 d3 1b b1 98 6a 65 4c bb a1 ad f8  .uI.9....jeL....
00000160: 84 9f 68 0a 7f 69 95 6d 2f e3 0a 3c c5 0a 57 35  ..h..i.m/..<..W5
00000170: 59 41 8a 5e 44 b8 56 40 f8 81 b6 69 5d f8 ea 3d  YA.^D.V@...i]..=
00000180: b4 82 af d1 bb 7c 5e b3 fd f5 70 a4 ef 23 55 d2  .....|^...p..#U.
00000190: e9 01 1b e9 5d b1 ab af e6 2b be 66 77 22 92 e4  ....]....+.fw"..
000001a0: 77 09 ff 2c 72 35 44 10 ff 4d 87 c6 eb 2b 9c 69  w..,r5D..M...+.i
000001b0: b4 a0 31 58 b8 0a 21 79 dc e2 81 d0 74 dc 2e d7  ..1X..!y....t...
000001c0: 31 1e aa dd e2 b9 5c b6 0e d9 97 af a5 cc 3f 2c  1.....\.......?,
000001d0: 80 cc 1f 7c 6b b6 8a e4 d8 b7 c4 c2 07 a8 d1 d8  ...|k...........
000001e0: 2c 86 9c 97 80 a3 e7 85 bf 3e 20 c2 fe ee f5 89  ,........> .....
000001f0: f7 aa 8d 2d ea 1f 5c 88 cb 46 d5 a4 4c c0 88 02  ...-..\..F..L...
00000200: 10 e9 7f 22 ef f3 2a ed c2 05 40 86 ae f6 38 f2  ..."..*...@...8.
00000210: ed 57 85 05 79 2d b9 8e 72 89 a5 5b 5a 56 25 eb  .W..y-..r..[ZV%.
00000220: 3a d2 1e 19 cb 7f 13 64 94 e8 a6 a1 67 f6 a0 ec  :......d....g...
00000230: d1 95 ee 73 1b 85 7b 67 2d c3 bf 6c c3 4f 43 e7  ...s..{g-..l.OC.
00000240: fc 95 46 d4 43 bf 39 41 4b 1b b3 01 5e cc ae 2d  ..F.C.9AK...^..-
00000250: 68 8d e0 1d ee 9b 9e ff af 35 80 88 09 82 fe 0d  h........5......
00000260: 30 6b b2 3c 58 af 7c 28 d0 75 22 41 64 b9 58 37  0k.<X.|(.u"Ad.X7
00000270: a5 12 14 38 69 25 58 5d 8c 3b c3 9d b5 a3 f5 05  ...8i%X].;......
00000280: 3c 57 7f 77 a9 c1 34 ae bf 2c e1 6e a2 76 36 72  <W.w..4..,.n.v6r
00000290: 99 8d 8c 43 fe 4a e7 d1 ed 9d c4 52 82 ae 57 f0  ...C.J.....R..W.
000002a0: e4 d9 3f 4a d7 11 d7 b7 ce 1c db de 32 9a 90 43  ..?J........2..C
000002b0: 21 85 4f 88 ac 79 de 6b aa d4 57 0b 9d 06 1e 0d  !.O..y.k..W.....
000002c0: bd d0 63 a9 26 c0 10 10 a5 2f 8e 6f f1 9e 58 ff  ..c.&..../.o..X.
000002d0: a3 6f 46 73 ac 5b 93 b3 cb a5 63 68 90 ac d1 23  .oFs.[....ch...#
000002e0: 96 42 99 f9 ae 66 6a aa 99 14 69 a9 cc 1d eb dd  .B...fj...i.....
000002f0: bc 03 c5 6e 8d 61 dd d3 1e bb 20 bb a9 5c 25 b4  ...n.a.... ..\%.
00000300: ec e4 b7 99 52 b5 23 a3 b6 54 1d 65 c5 1e 83 09  ....R.#..T.e....
00000310: ca 85 df b5 e3 b1 33 8d 22 e6 70 91 c3 7b 09 5a  ......3.".p..{.Z
00000320: 82 81 a4 fa 07 68 f4 9c e2 22 67 88 ec 4e 54 3e  .....h..."g..NT>
00000330: b0 22 4f 38 e9 1d c1 ee f1 a4 e6 82 42 bd 8f 35  ."O8........B..5
00000340: 38 ec 0b 13 de 3f ec 81 c7 e4 44 a5 7c 8f 44 f7  8....?....D.|.D.
00000350: 03 85 a4 26 42 d6 9c 51 8e b4 6d a7 84 42 94 61  ...&B..Q..m..B.a
00000360: 77 a7 b2 a5 cb b5 a0 23 ee 83 a6 2d b6 d8 68 1c  w......#...-..h.
00000370: a1 c4 f5 6c 4a 16 03 f8 3c 99 a1 88 7b 2a ce ad  ...lJ...<...{*..
00000380: fc c1 15 f1 ab 2d 93 ce 6c 87 dd 06 9a bf 11 b6  .....-..l.......
00000390: d1 c0 22 79 ad 33 cb ee 39 6d ce c3 2c 0c 59 34  .."y.3..9m..,.Y4
000003a0: e0 2f 28 99 d2 cc aa 7e 3b 6a 3b 84 d5 10 8b 5a  ./(....~;j;....Z
000003b0: f9 5a 62 59 45 9a df 53 fb ff e4 d6 52 4b 26 92  .ZbYE..S....RK&.
000003c0: 99 8e b8 a4 af 65 fc f9 af 89 67 d4 74 b7 2a d4  .....e....g.t.*.
000003d0: e0 56 11 77 28 d5 dd 26 1f 67 39 01 30 74 9a 4c  .V.w(..&.g9.0t.L
000003e0: ee 7b 8d 2e 16 88 27 58 f0 3a 06 c3 39 92 2f 29  .{....'X.:..9./)
000003f0: 33 2d 90 ca 54 c5 20 80 a4 bb c0 52 68 4d ff c2  3-..T. ....RhM..
00000400: 50 26 b8 7e 2a 9e 92 52 19 0a d9 44 e8 c3 86 8e  P&.~*..R...D....
00000410: 12 c8 33 00 ba d7 9a 62 a9 9d 62 b5 f4 cb a5 7f  ..3....b..b.....
00000420: a7 ac 9b d9 2e c1 b3 dc 9d cb c6 f3 71 94 4d 07  ............q.M.
00000430: c7 65 2f 8d 87 13 1e 8d 19 a1 9f 05 19 9b 9d 35  .e/............5
00000440: 77 79 55 a7 53 fe 24 ce dc cd 4e 59 a6 85 3a c6  wyU.S.$...NY..:.
00000450: fc d7 c0 8b 38 b5 97 68 26 5a af 36 88 43 66 41  ....8..h&Z.6.CfA
00000460: 35 3d f6 70 7c f6 13 0a bd 3d 94 17 da 86 d9 74  5=.p|....=.....t
00000470: 28 6c e8 02 65                                   (l..e


7.3.11.7. Публикация файлов. В наших учебных целях скопируем в общее место [/tmp] и проверим содержимое каталога.


example > ls -l /tmp
total 44
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root    7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root  659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root  438 Apr  6 20:13 message_to_buratino.txt.sig
-rw-r--r-- 1 root root  748 Apr  6 20:13 message_to_malvina.txt.asc
-rw-r--r-- 1 root root  505 Apr  6 20:13 message_to_malvina.txt.gpg

example malvina > cp -v /tmp/dir_malvina/message_to_buratino_2.txt.gpg /tmp
'/tmp/dir_malvina/message_to_buratino_2.txt.gpg' -> '/tmp/message_to_buratino_2.txt.gpg'

example > ls -l /tmp
total 48
-rw-r--r-- 1 root root 3151 Apr  6 20:13 buratino_ascii.pgp
-rw-r--r-- 1 root root 2267 Apr  6 20:13 buratino_bin.pgp
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_buratino
drwxr-xr-x 4 root root 4096 Apr  6 20:13 dir_malvina
-rw-r--r-- 1 root root 2456 Apr  6 20:13 malvina_ascii.pgp
-rw-r--r-- 1 root root 1754 Apr  6 20:13 malvina_bin.pgp
-rw-r--r-- 1 root root 1111 Apr  6 20:13 message_to_buratino_2.txt.gpg
-rw-r--r-- 1 root root    7 Apr  6 20:13 message_to_buratino.txt
-rw-r--r-- 1 root root  659 Apr  6 20:13 message_to_buratino.txt.asc
-rw-r--r-- 1 root root  438 Apr  6 20:13 message_to_buratino.txt.sig
-rw-r--r-- 1 root root  748 Apr  6 20:13 message_to_malvina.txt.asc
-rw-r--r-- 1 root root  505 Apr  6 20:13 message_to_malvina.txt.gpg


    malvina
    +-----+----------+------------------------------------------+
    | sec | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | malvina  | E863BA814540018D08AA519101C2ABCE329C32E4 |
    | pub | buratino | 744331AE1D8C709352A197FEDC3CCB8F4B75702C |
    +-----+----------+------------------------------------------+

    [ file: malvina_bin.key ]
    [ file: malvina_ascii.key ]
    [ file: message_to_buratino.txt ]
    [ file: message_to_buratino.txt.sig ]
    [ file: message_to_buratino.txt.asc ]
    [ file: message_to_malvina.txt ]
    [ file: message_to_buratino_2.txt ]
    [ file: message_to_buratino_2.txt.gpg ] >----------------------+
                                                                   |
    PUBLIC AREA                                                    |
    [ file: malvina_bin.key ]                                      |
    [ file: malvina_ascii.key ]                                    |
    [ file: buratino_bin.key ]                                     |
    [ file: buratino_ascii.key ]                                   |
    [ file: message_to_buratino.txt ]                              |
    [ file: message_to_buratino.txt.sig ]                          |
    [ file: message_to_buratino.txt.asc ]                          |
    [ file: message_to_malvina.txt.gpg ]                           |
    [ file: message_to_malvina.txt.asc ]                           |
    [ file: message_to_buratino_2.txt.gpg ] <----------------------+


7.3.12. Дешифрование с проверкой подписи.

    O_o.

7.3.12.0. Применив команду [--decrypt] к зашифрованному файлу в любом формате осуществим дешифрование содержимого. Опцию [--output] опустим чтобы основательно запутаться среди информационных сообщений на экране.


example buratino > gpg -v --homedir /tmp/dir_buratino/ --no-permission-warning --decrypt /tmp/message_to_buratino_2.txt.gpg
gpg: public key is 878167245DEA6988
gpg: connection to agent established
gpg: using subkey 878167245DEA6988 instead of primary key DC3CCB8F4B75702C
gpg: pinentry launched ( * )
gpg: using subkey 878167245DEA6988 instead of primary key DC3CCB8F4B75702C
gpg: encrypted with 4096-bit RSA key, ID 878167245DEA6988, created 2013-04-06
      "Buratino (free boy) <buratino@mail>"
gpg: AES256 encrypted data
gpg: original file name='message_to_buratino_2.txt'
Hey, you write to me: We have a problem?
gpg: Signature made Sat 06 Apr 2013 06:04:13 PM MMM
gpg:                using RSA key E863BA814540018D08AA519101C2ABCE329C32E4
gpg: using pgp trust model
gpg: Good signature from "Malvina Karabasovna <malvina@mail>" [full]
gpg: binary signature, digest algorithm SHA512, key algorithm rsa3072


    Ах да дополнительно обратите внимание на идентификатор "original file name=". На этот раз сообщение имеет подпись.

7.3.13. Так бегло пробежались по вершкам. Вникнув в описание можно реально много чего подчерпнуть. ист.man gpg,lxf-2013-117,lxf-2013-174,lxf-2017-223.

7.8. Консольный доступ.

    Обычный пользователь не желает в руках держать ничего тяжелее мышки, возможно это вынужденная мера, и тем самым ограничивает предоставляемую гибкость инструментов имеющих консольный доступ. Консольный доступ может оказаться одной из составляющих реализации защиты "Карточный домик".

7.9. Level 7

     Вольно/невольно придется часто с ним пересекаться и чем раньше пропитаетесь, тем надежнее укроетесь под 7 уровенем по CS.

------------- ---- ------

Copyright (C) 1990-2018 Free Software DavydovMA

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
